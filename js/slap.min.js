function Slap(t){var e=this;const r=0,n=1,o=2,a="Multiplas timelines!",s="O símbolo TIMELINE não foi encontrado!",u="Não há símbolos suficientes!",c="O símbolo de controle não foi encontrado!",h="OK";var m=[],y=null==t.canvas?document.getElementById("initCanvas"):t.canvas,w=y.getContext("2d"),k=15,_=15,E=0,S=20,A=[],C=[],O=h;if(null!=t)for(var B in t)e[B]=t[B];if(""!=e.imageSrc){var D=new Image;D.onload=function(){y.width=D.width,y.height=D.height,w.drawImage(D,0,0,D.width,D.height);var t=w.getImageData(0,0,D.width,D.height),r=tracking.Image.grayscale(t.data,D.width,D.height,!0);w.putImageData(new ImageData(r,D.width,D.height),0,0),e.imageLoaded=!0,e.isLoadingImage=!1},D.src=e.imageSrc,e.isLoadingImage=!0}e.test=function(){e.loadNetFromJSON(e.file),e.addListener(r,function(){console.log("JSON LOADED"),e.addListener(o,function(){console.log("IMAGE LOADED"),e.getContextInformation(),e.addListener(n,function(){console.log("SYMBOLS RECOGNIZED");for(var t=0;t<m.length;t++){m[t].index=t,m[t].output=e.net.run(m[t].input);var r=[];for(var n in m[t].output)r.push({key:n,value:m[t].output[n]});m[t].bestValue=e.getBestValue(r)}e.onTested()})})})},e.onTested=function(){var t=m.slice(0);if(O==h){for(var r=S,n=0;n<t.length;n++)"timeline"==t[n].bestValue.key?A.push({timeline:e.cloneObject(t[n]),points:[],control:null,error:h}):"point"==t[n].bestValue.key&&C.push({pointObject:e.cloneObject(t[n]),name:""});if(0==A.length)O=s;else{for(var i=0;i<A.length;i++){for(var n=0;n<t.length;n++)if(t[n].bestValue.value>E){var o=t[n].x,a=t[n].width,l=A[i].timeline.x,f=A[i].timeline.width;if(r=A[i].timeline.height,o>l-r&&l+f+r>o&&o+a>l-r&&l+f+r>o+a){var g=t[n].y,d=t[n].height,p=A[i].timeline.y,v=A[i].timeline.height;p>g&&g>p-d-r&&(A[i].control=e.cloneObject(t[n]))}}e.orderPoints(A[i].points)}for(var i=0;i<A.length;i++){for(var n=0;n<t.length;n++)if(t[n].bestValue.value>E){var o=t[n].x,a=t[n].width,l=A[i].timeline.x,f=A[i].timeline.width;if(r=A[i].timeline.height,o>l-r-a&&l+r>o||o>l+f-a-r&&l+f+a+r>o){var g=t[n].y,d=t[n].height,p=A[i].timeline.y,v=A[i].timeline.height;if(g>p+v&&p+v+d>g){var y=e.cloneObject(t[n]);A[i].points.push(y)}}}e.orderPoints(A[i].points)}}console.log("Foram encontrados ",C.length," pontos ");for(var n=0;n<C.length;n++)for(var w=C[n].pointObject.x,k=C[n].pointObject.y,b=C[n].pointObject.width,_=C[n].pointObject.height,L=0;L<m.length;L++)if(m[L]!=C[n].pointObject&&m[L].bestValue.value>=E){var T=m[L].x,x=m[L].y;m[L].width,m[L].height;r=C[n].pointObject.height,T>w&&w+b>T&&x>k+_&&k+_+r>x&&(C[n].name=m[L].bestValue.key)}C.sort(function(t,e){return t.name.charCodeAt(0)==e.name.charCodeAt(0)?0:t.name.charCodeAt(0)<e.name.charCodeAt(0)?-1:1})}for(var n=0;n<A.length;n++)A[n].points.length<2&&(A[n].error=u),null==A[n].control&&(A[n].error=c);console.log("OBJECTVECTOR",m),e.onRecognized()},e.cloneObject=function(t){var e={};for(var r in t.output)e[r]=t.output[r];var n={x:t.x,y:t.y,width:t.width,height:t.height,res:t.res,input:t.input,output:e,index:t.index,bestValue:{key:t.bestValue.key,value:t.bestValue.value}};return n},e.lookForPoint=function(t){for(var e=null,r=0;r<C.length;r++)C[r].name==t&&(e=C[r].pointObject);return e},e.getCommands=function(){return A},e.getScenePoints=function(){return C},e.getObjectVector=function(){return m},e.getFrames=function(){for(var t=[],e=0;e<m.length;e++)"frame"==m[e].bestValue.key&&(m[e].frameControl="",t.push(m[e]));for(var r=S,e=0;e<t.length;e++)for(var n=t[e].x,i=t[e].x+t[e].width,o=t[e].y,a=0;a<m.length;a++)a!=t[e].index&&(py=m[a].y+m[a].height,m[a].x>=n&&m[a].x<=i&&py>=o-r&&py<o&&(t[e].frameControl=m[a].bestValue.key));return t},e.onRecognized=function(){for(i=0;i<A.length;i++)console.log(i+" -> timeline: "+m.indexOf(A[i].timeline)+" - "+A[i].error);console.log(A),console.log(C),console.log(m)},e.orderPoints=function(t,e){switch(null==e&&(e="x"),e.toUpperCase()){case"X":t.sort(function(t,e){return t.x==e.x?0:t.x<e.x?-1:1});break;case"Y":t.sort(function(t,e){return t.y==e.y?0:t.y<e.y?-1:1})}},e.addListener=function(t,i){t==r&&(e.interval=setInterval(function(){(!e.isJsonLoading||e.jsonLoaded)&&(i(),clearInterval(e.interval))},1)),t==n&&(e.interval2=setInterval(function(){(!e.isGettingInfo||e.gotInfo)&&(i(),clearInterval(e.interval2))},1)),t==o&&(e.interval3=setInterval(function(){(!e.isLoadingImage||e.imageLoaded)&&(i(),clearInterval(e.interval3))},1))},e.loadNetFromJSON=function(t){var r=new XMLHttpRequest;e.isJsonLoading=!0,e.jsonLoaded=!1,e.jsonLoaded=!1,r.overrideMimeType("application/json"),r.open("GET",t,!0),r.onreadystatechange=function(){4==r.readyState&&"200"==r.status&&e.onJSONLoad(r.responseText)},r.send(null)},e.onJSONLoad=function(t){var r=JSON.parse(t);e.net=new brain.NeuralNetwork({hiddenLayers:[4],learningRate:.6}),e.net.fromJSON(r),e.netData=e.net.getData(),e.isJsonLoading=!1,e.jsonLoaded=!0},e.getBestValue=function(t){for(var e=t[0].value,n=t[0].key,i=0;i<t.length;i++)t[i].value>e&&(e=t[i].value,n=t[i].key);return{value:e,key:n}},e.getContextInformation=function(){function r(t,e,r,n,a){var s=[],u=r/k,c=n/_;for(b=0;b<_;b++)for(var h=e+b*c,l=e+(b+1)*c,f=0;k>f;f++){var g=t+f*u,d=t+(f+1)*u;s.push(0);var p=!i(o("canvas"+b+"-"+f,y,g,h,d-g,l-h));s[s.length-1]=p?1:0}return s}function i(t){var e=document.createElement("canvas");return e.width=t.width,e.height=t.height,t.toDataURL()==e.toDataURL()}function o(t,e,r,n,i,o){var a=document.createElement("canvas");return a.width=i,a.height=o,a.getContext("2d").drawImage(e,r,n,i,o,0,0,i,o),a}function a(t,e,r,n,i,o,a){w.fillStyle="rgba(255,0,0,0.2)";var s=0,u=r/k,c=n/_;w.beginPath(),w.strokeStyle=i,w.rect(t,e,r,n),w.stroke(),w.font="20px Georgia",w.fillText(a,t+r+10,e);for(var h=0;k>h;h++)for(var l=0;_>l;l++)1==o[s]&&(w.beginPath(),w.rect(t+l*u,e+h*c,u,c),w.fill()),s++}e.gotInfo=!1,e.isGettingInfo=!0,tracking.ColorTracker.registerColor("threshold",function(t,e,r){return t>0});var t=new tracking.ColorTracker(["threshold"]);t.setMinDimension(2),t.setMinGroupSize(2),t.on("track",function(t){var n=0,i=t.data.length;4>i&&(O=u),m=[],t.data.forEach(function(t){var o=r(t.x,t.y,t.width,t.height,t.color);console.log(n+1+" of "+i),m.push({input:o,x:t.x,y:t.y,width:t.width,height:t.height,res:-1}),a(t.x,t.y,t.width,t.height,"#f00",o,n),n++,n==i&&(e.objectVector=m,e.gotInfo=!0,e.isGettingInfo=!1)})}),tracking.track("#"+e.canvas.id,t)},e.getError=function(t){switch(t){case"ERROR_MULTI_TIMELINE":return a;case"ERROR_NO_TIMELINE":return s;case"ERROR_NOT_ENOUGH_SYMBOLS":return u;case"ERROR_NO_CONTROL":return c;case"NO_ERROR":return h}},e.getProperty=function(t){return e[t]},e.setProperty=function(t,r){e[t]=r}}!function t(e,r,n){function i(a,s){if(!r[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=r[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return i(r?r:t)},c,c.exports,t,e,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(t,e,r){brain=t("./lib/brain")},{"./lib/brain":2}],2:[function(t,e,r){r.NeuralNetwork=t("./neuralnetwork").NeuralNetwork,r.crossValidate=t("./cross-validate")},{"./cross-validate":3,"./neuralnetwork":5}],3:[function(t,e,r){function n(t,e,r,n,o){var a=new t(e),s=Date.now(),u=a.train(n,r),c=Date.now(),h=a.test(o),l=Date.now(),f=i(h).extend({trainTime:c-s,testTime:l-c,iterations:u.iterations,trainError:u.error,learningRate:a.learningRate,hidden:a.hiddenSizes,network:a.toJSON()});return f}var i=t("underscore")._;e.exports=function(t,e,r,o,a){a=a||4;var s=e.length/a;e=i(e).sortBy(function(){return Math.random()});var u={error:0,trainTime:0,testTime:0,iterations:0,trainError:0},c={truePos:0,trueNeg:0,falsePos:0,falseNeg:0,total:0},h=[],l=i.range(a).map(function(a){var l=i(e).clone(),f=l.splice(a*s,s),g=l,d=n(t,r,o,g,f);return i(u).each(function(t,e){u[e]=t+d[e]}),i(c).each(function(t,e){c[e]=t+d[e]}),h.push(d.misclasses),d});return i(u).each(function(t,e){u[e]=t/a}),c.precision=c.truePos/(c.truePos+c.falsePos),c.recall=c.truePos/(c.truePos+c.falseNeg),c.accuracy=(c.trueNeg+c.truePos)/c.total,c.testSize=s,c.trainSize=e.length-s,{avgs:u,stats:c,sets:l,misclasses:i(h).flatten()}}},{underscore:20}],4:[function(t,e,r){function n(t){var e=u(t).reduce(function(t,e){return u(t).extend(e)},{});return i(e)}function i(t){var e={},r=0;for(var n in t)e[n]=r++;return e}function o(t,e){var r=[];for(var n in t)r[t[n]]=e[n]||0;return r}function a(t,e){var r={};for(var n in t)r[n]=e[t[n]];return r}function s(t){for(var e={},r=0,n=t.length;n-->0;)e[t[n]]=r++;return e}var u=t("underscore");e.exports={buildLookup:n,lookupFromHash:i,toArray:o,toHash:a,lookupFromArray:s}},{underscore:20}],5:[function(t,e,r){function n(){return.4*Math.random()-.2}function i(t){for(var e=new Array(t),r=0;t>r;r++)e[r]=0;return e}function o(t){for(var e=new Array(t),r=0;t>r;r++)e[r]=n();return e}function a(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return e/t.length}function s(t){if(h.call(this,{objectMode:!0}),t=t||{},!t.neuralNetwork)throw new Error("no neural network specified");return this.neuralNetwork=t.neuralNetwork,this.dataFormatDetermined=!1,this.inputKeys=[],this.outputKeys=[],this.i=0,this.iterations=t.iterations||2e4,this.errorThresh=t.errorThresh||.005,this.log=t.log||!1,this.logPeriod=t.logPeriod||10,this.callback=t.callback,this.callbackPeriod=t.callbackPeriod||10,this.floodCallback=t.floodCallback,this.doneTrainingCallback=t.doneTrainingCallback,this.size=0,this.count=0,this.sum=0,this.on("finish",this.finishStreamIteration),this}var u=t("underscore"),c=t("./lookup"),h=t("stream").Writable,l=t("inherits"),f=function(t){t=t||{},this.learningRate=t.learningRate||.3,this.momentum=t.momentum||.1,this.hiddenSizes=t.hiddenLayers,this.binaryThresh=t.binaryThresh||.5,t!={}&&(this.data=t.data)};f.prototype={initialize:function(t){this.sizes=t,this.outputLayer=this.sizes.length-1,this.biases=[],this.weights=[],this.outputs=[],this.deltas=[],this.changes=[],this.errors=[];for(var e=0;e<=this.outputLayer;e++){var r=this.sizes[e];if(this.deltas[e]=i(r),this.errors[e]=i(r),this.outputs[e]=i(r),e>0){this.biases[e]=o(r),this.weights[e]=new Array(r),this.changes[e]=new Array(r);for(var n=0;r>n;n++){var a=this.sizes[e-1];this.weights[e][n]=o(a),this.changes[e][n]=i(a)}}}},run:function(t){this.inputLookup&&(t=c.toArray(this.inputLookup,t));var e=this.runInput(t);return this.outputLookup&&(e=c.toHash(this.outputLookup,e)),e},runInput:function(t){this.outputs[0]=t;for(var e=1;e<=this.outputLayer;e++){for(var r=0;r<this.sizes[e];r++){for(var n=this.weights[e][r],i=this.biases[e][r],o=0;o<n.length;o++)i+=n[o]*t[o];this.outputs[e][r]=1/(1+Math.exp(-i))}var a=t=this.outputs[e]}return a},getData:function(){return this.data},train:function(t,e){this.data=t,t=this.formatData(t),e=e||{};var r=e.iterations||2e4,n=e.errorThresh||.005,i=e.log||!1,o=e.logPeriod||10,a=e.callback,s=e.callbackPeriod||10,c=t[0].input.length,h=t[0].output.length,l=this.hiddenSizes;l||(l=[Math.max(3,Math.floor(c/2))]);var f=u([c,l,h]).flatten();this.initialize(f);for(var g=1,d=0;r>d&&g>n;d++){for(var p=0,v=0;v<t.length;v++){var m=this.trainPattern(t[v].input,t[v].output);p+=m}g=p/t.length,i&&d%o==0&&console.log("iterations:",d,"training error:",g),a&&d%s==0&&a({error:g,iterations:d})}return{error:g,iterations:d}},trainPattern:function(t,e){this.runInput(t),this.calculateDeltas(e),this.adjustWeights();var r=a(this.errors[this.outputLayer]);return r},calculateDeltas:function(t){for(var e=this.outputLayer;e>=0;e--)for(var r=0;r<this.sizes[e];r++){var n=this.outputs[e][r],i=0;if(e==this.outputLayer)i=t[r]-n;else for(var o=this.deltas[e+1],a=0;a<o.length;a++)i+=o[a]*this.weights[e+1][a][r];this.errors[e][r]=i,this.deltas[e][r]=i*n*(1-n)}},adjustWeights:function(){for(var t=1;t<=this.outputLayer;t++)for(var e=this.outputs[t-1],r=0;r<this.sizes[t];r++){for(var n=this.deltas[t][r],i=0;i<e.length;i++){var o=this.changes[t][r][i];o=this.learningRate*n*e[i]+this.momentum*o,this.changes[t][r][i]=o,this.weights[t][r][i]+=o}this.biases[t][r]+=this.learningRate*n}},formatData:function(t){if(!u.isArray(t)){var e=[];e.push(t),t=e}var r=t[0].input;return u(r).isArray()||r instanceof Float64Array||(this.inputLookup||(this.inputLookup=c.buildLookup(u(t).pluck("input"))),t=t.map(function(t){var e=c.toArray(this.inputLookup,t.input);return u(u(t).clone()).extend({input:e})},this)),u(t[0].output).isArray()||(this.outputLookup||(this.outputLookup=c.buildLookup(u(t).pluck("output"))),t=t.map(function(t){var e=c.toArray(this.outputLookup,t.output);return u(u(t).clone()).extend({output:e})},this)),t},test:function(t){t=this.formatData(t);for(var e=1==t[0].output.length,r=0,n=0,i=0,o=0,s=[],c=0,h=0;h<t.length;h++){var l,f,g=this.runInput(t[h].input),d=t[h].output;if(e?(l=g[0]>this.binaryThresh?1:0,f=d[0]):(l=g.indexOf(u(g).max()),f=d.indexOf(u(d).max())),l!=f){var p=t[h];u(p).extend({actual:l,expected:f}),s.push(p)}e&&(0==l&&0==f?o++:1==l&&1==f?i++:0==l&&1==f?n++:1==l&&0==f&&r++);var v=g.map(function(t,e){return d[e]-t});c+=a(v)}var m=c/t.length,y={error:m,misclasses:s};return e&&u(y).extend({trueNeg:o,truePos:i,falseNeg:n,falsePos:r,total:t.length,precision:i/(i+r),recall:i/(i+n),accuracy:(o+i)/t.length}),y},toJSON:function(){for(var t=[],e=0;e<=this.outputLayer;e++){t[e]={};var r;r=0==e&&this.inputLookup?u(this.inputLookup).keys():e==this.outputLayer&&this.outputLookup?u(this.outputLookup).keys():u.range(0,this.sizes[e]);for(var n=0;n<r.length;n++){var i=r[n];if(t[e][i]={},e>0){t[e][i].bias=this.biases[e][n],t[e][i].weights={};for(var o in t[e-1]){var a=o;1==e&&this.inputLookup&&(a=this.inputLookup[o]),t[e][i].weights[o]=this.weights[e][n][a]}}}}return{layers:t,outputLookup:!!this.outputLookup,inputLookup:!!this.inputLookup,data:this.data}},fromJSON:function(t){var e=t.layers.length;this.data=t.data,this.outputLayer=e-1,this.sizes=new Array(e),this.weights=new Array(e),this.biases=new Array(e),this.outputs=new Array(e);for(var r=0;r<=this.outputLayer;r++){var n=t.layers[r];0!=r||n[0]&&!t.inputLookup?r!=this.outputLayer||n[0]&&!t.outputLookup||(this.outputLookup=c.lookupFromHash(n)):this.inputLookup=c.lookupFromHash(n);var i=u(n).keys();this.sizes[r]=i.length,this.weights[r]=[],this.biases[r]=[],this.outputs[r]=[];for(var o in i){var a=i[o];this.biases[r][o]=n[a].bias,this.weights[r][o]=u(n[a].weights).toArray()}}return this},toFunction:function(){var t=this.toJSON();return new Function("input","  var net = "+JSON.stringify(t)+";\n\n  for (var i = 1; i < net.layers.length; i++) {\n    var layer = net.layers[i];\n    var output = {};\n    \n    for (var id in layer) {\n      var node = layer[id];\n      var sum = node.bias;\n      \n      for (var iid in node.weights) {\n        sum += node.weights[iid] * input[iid];\n      }\n      output[id] = (1 / (1 + Math.exp(-sum)));\n    }\n    input = output;\n  }\n  return output;")},createTrainStream:function(t){return t=t||{},t.neuralNetwork=this,this.trainStream=new s(t),this.trainStream}},r.NeuralNetwork=f,l(s,h),s.prototype._write=function(t,e,r){if(!t)return this.emit("finish"),r();if(!this.dataFormatDetermined)return this.size++,this.inputKeys=u.union(this.inputKeys,u.keys(t.input)),this.outputKeys=u.union(this.outputKeys,u.keys(t.output)),this.firstDatum=this.firstDatum||t,r();this.count++;var n=this.neuralNetwork.formatData(t);this.trainDatum(n[0]),r()},s.prototype.trainDatum=function(t){var e=this.neuralNetwork.trainPattern(t.input,t.output);this.sum+=e},s.prototype.finishStreamIteration=function(){if(this.dataFormatDetermined&&this.size!==this.count&&console.log("This iteration's data length was different from the first."),!this.dataFormatDetermined){this.neuralNetwork.inputLookup=c.lookupFromArray(this.inputKeys),this.neuralNetwork.outputLookup=c.lookupFromArray(this.outputKeys);var t=this.neuralNetwork.formatData(this.firstDatum),e=t[0].input.length,r=t[0].output.length,n=this.hiddenSizes;n||(n=[Math.max(3,Math.floor(e/2))]);var i=u([e,n,r]).flatten();return this.dataFormatDetermined=!0,this.neuralNetwork.initialize(i),void("function"==typeof this.floodCallback&&this.floodCallback())}var o=this.sum/this.size;if(this.log&&this.i%this.logPeriod==0&&console.log("iterations:",this.i,"training error:",o),this.callback&&this.i%this.callbackPeriod==0&&this.callback({error:o,iterations:this.i}),this.sum=0,this.count=0,this.i++,this.i<this.iterations&&o>this.errorThresh){if("function"==typeof this.floodCallback)return this.floodCallback()}else if("function"==typeof this.doneTrainingCallback)return this.doneTrainingCallback({error:o,iterations:this.i})}},{"./lookup":4,inherits:19,stream:12,underscore:20}],6:[function(t,e,r){function n(t,e,r){if(!(this instanceof n))return new n(t,e,r);var i=typeof t;if("base64"===e&&"string"===i)for(t=S(t);t.length%4!==0;)t+="=";var o;if("number"===i)o=M(t);else if("string"===i)o=n.byteLength(t,e);else{if("object"!==i)throw new Error("First argument needs to be a number, array or string.");o=M(t.length)}var a;n._useTypedArrays?a=A(new Uint8Array(o)):(a=this,a.length=o,a._isBuffer=!0);var s;if(n._useTypedArrays&&"function"==typeof Uint8Array&&t instanceof Uint8Array)a._set(t);else if(O(t))for(s=0;o>s;s++)n.isBuffer(t)?a[s]=t.readUInt8(s):a[s]=t[s];else if("string"===i)a.write(t,0,e);else if("number"===i&&!n._useTypedArrays&&!r)for(s=0;o>s;s++)a[s]=0;return a}function i(t,e,r,i){r=Number(r)||0;var o=t.length-r;i?(i=Number(i),i>o&&(i=o)):i=o;var a=e.length;J(a%2===0,"Invalid hex string"),i>a/2&&(i=a/2);for(var s=0;i>s;s++){var u=parseInt(e.substr(2*s,2),16);J(!isNaN(u),"Invalid hex string"),t[r+s]=u}return n._charsWritten=2*s,s}function o(t,e,r,i){var o=n._charsWritten=F(B(e),t,r,i);return o}function a(t,e,r,i){var o=n._charsWritten=F(D(e),t,r,i);return o}function s(t,e,r,n){return a(t,e,r,n)}function u(t,e,r,i){var o=n._charsWritten=F(U(e),t,r,i);return o}function c(t,e,r,i){var o=n._charsWritten=F(N(e),t,r,i);return o}function h(t,e,r){return 0===e&&r===t.length?G.fromByteArray(t):G.fromByteArray(t.slice(e,r))}function l(t,e,r){var n="",i="";r=Math.min(t.length,r);for(var o=e;r>o;o++)t[o]<=127?(n+=P(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return n+P(i)}function f(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n}function g(t,e,r){return f(t,e,r)}function d(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",o=e;r>o;o++)i+=R(t[o]);return i}function p(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function v(t,e,r,n){n||(J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o;return r?(o=t[e],i>e+1&&(o|=t[e+1]<<8)):(o=t[e]<<8,i>e+1&&(o|=t[e+1])),o}}function m(t,e,r,n){n||(J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o;return r?(i>e+2&&(o=t[e+2]<<16),i>e+1&&(o|=t[e+1]<<8),o|=t[e],i>e+3&&(o+=t[e+3]<<24>>>0)):(i>e+1&&(o=t[e+1]<<16),i>e+2&&(o|=t[e+2]<<8),i>e+3&&(o|=t[e+3]),o+=t[e]<<24>>>0),o}}function y(t,e,r,n){n||(J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o=v(t,e,r,!0),a=32768&o;return a?-1*(65535-o+1):o}}function w(t,e,r,n){n||(J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o=m(t,e,r,!0),a=2147483648&o;return a?-1*(4294967295-o+1):o}}function k(t,e,r,n){return n||(J("boolean"==typeof r,"missing or invalid endian"),J(e+3<t.length,"Trying to read beyond buffer length")),q.read(t,e,r,23,4)}function b(t,e,r,n){return n||(J("boolean"==typeof r,"missing or invalid endian"),J(e+7<t.length,"Trying to read beyond buffer length")),q.read(t,e,r,52,8)}function _(t,e,r,n,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==r&&null!==r,"missing offset"),J(r+1<t.length,"trying to write beyond buffer length"),z(e,65535));var o=t.length;if(!(r>=o))for(var a=0,s=Math.min(o-r,2);s>a;a++)t[r+a]=(e&255<<8*(n?a:1-a))>>>8*(n?a:1-a)}function E(t,e,r,n,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==r&&null!==r,"missing offset"),J(r+3<t.length,"trying to write beyond buffer length"),z(e,4294967295));var o=t.length;if(!(r>=o))for(var a=0,s=Math.min(o-r,4);s>a;a++)t[r+a]=e>>>8*(n?a:3-a)&255}function L(t,e,r,n,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==r&&null!==r,"missing offset"),J(r+1<t.length,"Trying to write beyond buffer length"),W(e,32767,-32768));var o=t.length;r>=o||(e>=0?_(t,e,r,n,i):_(t,65535+e+1,r,n,i))}function T(t,e,r,n,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==r&&null!==r,"missing offset"),J(r+3<t.length,"Trying to write beyond buffer length"),W(e,2147483647,-2147483648));var o=t.length;r>=o||(e>=0?E(t,e,r,n,i):E(t,4294967295+e+1,r,n,i))}function x(t,e,r,n,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==r&&null!==r,"missing offset"),J(r+3<t.length,"Trying to write beyond buffer length"),V(e,3.4028234663852886e38,-3.4028234663852886e38));var o=t.length;r>=o||q.write(t,e,r,n,23,4)}function I(t,e,r,n,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==r&&null!==r,"missing offset"),J(r+7<t.length,"Trying to write beyond buffer length"),V(e,1.7976931348623157e308,-1.7976931348623157e308));var o=t.length;r>=o||q.write(t,e,r,n,52,8)}function S(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function A(t){return t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=H.get,t.set=H.set,t.write=H.write,t.toString=H.toString,t.toLocaleString=H.toString,t.toJSON=H.toJSON,t.copy=H.copy,t.slice=H.slice,t.readUInt8=H.readUInt8,t.readUInt16LE=H.readUInt16LE,t.readUInt16BE=H.readUInt16BE,t.readUInt32LE=H.readUInt32LE,t.readUInt32BE=H.readUInt32BE,t.readInt8=H.readInt8,t.readInt16LE=H.readInt16LE,t.readInt16BE=H.readInt16BE,t.readInt32LE=H.readInt32LE,t.readInt32BE=H.readInt32BE,t.readFloatLE=H.readFloatLE,t.readFloatBE=H.readFloatBE,t.readDoubleLE=H.readDoubleLE,t.readDoubleBE=H.readDoubleBE,t.writeUInt8=H.writeUInt8,t.writeUInt16LE=H.writeUInt16LE,t.writeUInt16BE=H.writeUInt16BE,t.writeUInt32LE=H.writeUInt32LE,t.writeUInt32BE=H.writeUInt32BE,t.writeInt8=H.writeInt8,t.writeInt16LE=H.writeInt16LE,t.writeInt16BE=H.writeInt16BE,t.writeInt32LE=H.writeInt32LE,t.writeInt32BE=H.writeInt32BE,t.writeFloatLE=H.writeFloatLE,t.writeFloatBE=H.writeFloatBE,t.writeDoubleLE=H.writeDoubleLE,t.writeDoubleBE=H.writeDoubleBE,t.fill=H.fill,t.inspect=H.inspect,t.toArrayBuffer=H.toArrayBuffer,t}function C(t,e,r){return"number"!=typeof t?r:(t=~~t,t>=e?e:t>=0?t:(t+=e,t>=0?t:0))}function M(t){return t=~~Math.ceil(+t),0>t?0:t}function j(t){return(Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)})(t)}function O(t){return j(t)||n.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function R(t){return 16>t?"0"+t.toString(16):t.toString(16)}function B(t){for(var e=[],r=0;r<t.length;r++){var n=t.charCodeAt(r);if(127>=n)e.push(t.charCodeAt(r));else{var i=r;n>=55296&&57343>=n&&r++;for(var o=encodeURIComponent(t.slice(i,r+1)).substr(1).split("%"),a=0;a<o.length;a++)e.push(parseInt(o[a],16))}}return e}function D(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function N(t){for(var e,r,n,i=[],o=0;o<t.length;o++)e=t.charCodeAt(o),r=e>>8,n=e%256,i.push(n),i.push(r);return i}function U(t){return G.toByteArray(t)}function F(t,e,r,n){for(var i=0;n>i&&!(i+r>=e.length||i>=t.length);i++)e[i+r]=t[i];return i}function P(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}function z(t,e){J("number"==typeof t,"cannot write a non-number as a number"),J(t>=0,"specified a negative value for writing an unsigned value"),J(e>=t,"value is larger than maximum value for type"),J(Math.floor(t)===t,"value has a fractional component")}function W(t,e,r){J("number"==typeof t,"cannot write a non-number as a number"),J(e>=t,"value larger than maximum allowed value"),J(t>=r,"value smaller than minimum allowed value"),J(Math.floor(t)===t,"value has a fractional component")}function V(t,e,r){J("number"==typeof t,"cannot write a non-number as a number"),J(e>=t,"value larger than maximum allowed value"),J(t>=r,"value smaller than minimum allowed value")}function J(t,e){if(!t)throw new Error(e||"Failed assertion")}var G=t("base64-js"),q=t("ieee754");r.Buffer=n,r.SlowBuffer=n,r.INSPECT_MAX_BYTES=50,n.poolSize=8192,n._useTypedArrays=function(){if("function"!=typeof Uint8Array||"function"!=typeof ArrayBuffer)return!1;try{var t=new Uint8Array(0);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),n.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.isBuffer=function(t){return!(null===t||void 0===t||!t._isBuffer)},n.byteLength=function(t,e){var r;switch(t+="",e||"utf8"){case"hex":r=t.length/2;break;case"utf8":case"utf-8":r=B(t).length;break;case"ascii":case"binary":case"raw":r=t.length;break;case"base64":r=U(t).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*t.length;break;default:throw new Error("Unknown encoding")}return r},n.concat=function(t,e){if(J(j(t),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===t.length)return new n(0);if(1===t.length)return t[0];var r;if("number"!=typeof e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var i=new n(e),o=0;for(r=0;r<t.length;r++){var a=t[r];a.copy(i,o),o+=a.length}return i},n.prototype.write=function(t,e,r,n){if(isFinite(e))isFinite(r)||(n=r,r=void 0);else{var h=n;n=e,e=r,r=h}e=Number(e)||0;var l=this.length-e;r?(r=Number(r),r>l&&(r=l)):r=l,n=String(n||"utf8").toLowerCase();var f;switch(n){case"hex":f=i(this,t,e,r);break;case"utf8":case"utf-8":f=o(this,t,e,r);break;case"ascii":f=a(this,t,e,r);break;case"binary":f=s(this,t,e,r);break;case"base64":f=u(this,t,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":f=c(this,t,e,r);break;default:throw new Error("Unknown encoding")}return f},n.prototype.toString=function(t,e,r){var n=this;if(t=String(t||"utf8").toLowerCase(),e=Number(e)||0,r=void 0!==r?Number(r):r=n.length,r===e)return"";var i;switch(t){case"hex":i=d(n,e,r);break;case"utf8":case"utf-8":i=l(n,e,r);break;case"ascii":i=f(n,e,r);break;case"binary":i=g(n,e,r);break;case"base64":i=h(n,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=p(n,e,r);break;default:throw new Error("Unknown encoding")}return i},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},n.prototype.copy=function(t,e,r,n){var i=this;if(r||(r=0),n||0===n||(n=this.length),e||(e=0),n!==r&&0!==t.length&&0!==i.length){J(n>=r,"sourceEnd < sourceStart"),J(e>=0&&e<t.length,"targetStart out of bounds"),J(r>=0&&r<i.length,"sourceStart out of bounds"),J(n>=0&&n<=i.length,"sourceEnd out of bounds"),n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);for(var o=0;n-r>o;o++)t[o+e]=this[o+r]}},n.prototype.slice=function(t,e){var r=this.length;if(t=C(t,r,0),e=C(e,r,r),n._useTypedArrays)return A(this.subarray(t,e));for(var i=e-t,o=new n(i,void 0,!0),a=0;i>a;a++)o[a]=this[a+t];return o},n.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},n.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},n.prototype.readUInt8=function(t,e){return e||(J(void 0!==t&&null!==t,"missing offset"),J(t<this.length,"Trying to read beyond buffer length")),t>=this.length?void 0:this[t]},n.prototype.readUInt16LE=function(t,e){return v(this,t,!0,e)},n.prototype.readUInt16BE=function(t,e){return v(this,t,!1,e)},n.prototype.readUInt32LE=function(t,e){return m(this,t,!0,e)},n.prototype.readUInt32BE=function(t,e){return m(this,t,!1,e)},n.prototype.readInt8=function(t,e){if(e||(J(void 0!==t&&null!==t,"missing offset"),J(t<this.length,"Trying to read beyond buffer length")),!(t>=this.length)){var r=128&this[t];return r?-1*(255-this[t]+1):this[t]}},n.prototype.readInt16LE=function(t,e){return y(this,t,!0,e)},n.prototype.readInt16BE=function(t,e){return y(this,t,!1,e)},n.prototype.readInt32LE=function(t,e){return w(this,t,!0,e)},n.prototype.readInt32BE=function(t,e){return w(this,t,!1,e)},n.prototype.readFloatLE=function(t,e){return k(this,t,!0,e)},n.prototype.readFloatBE=function(t,e){return k(this,t,!1,e)},n.prototype.readDoubleLE=function(t,e){return b(this,t,!0,e)},n.prototype.readDoubleBE=function(t,e){return b(this,t,!1,e)},n.prototype.writeUInt8=function(t,e,r){r||(J(void 0!==t&&null!==t,"missing value"),J(void 0!==e&&null!==e,"missing offset"),J(e<this.length,"trying to write beyond buffer length"),z(t,255)),e>=this.length||(this[e]=t)},n.prototype.writeUInt16LE=function(t,e,r){_(this,t,e,!0,r)},n.prototype.writeUInt16BE=function(t,e,r){_(this,t,e,!1,r)},n.prototype.writeUInt32LE=function(t,e,r){E(this,t,e,!0,r)},n.prototype.writeUInt32BE=function(t,e,r){E(this,t,e,!1,r)},n.prototype.writeInt8=function(t,e,r){r||(J(void 0!==t&&null!==t,"missing value"),J(void 0!==e&&null!==e,"missing offset"),J(e<this.length,"Trying to write beyond buffer length"),W(t,127,-128)),e>=this.length||(t>=0?this.writeUInt8(t,e,r):this.writeUInt8(255+t+1,e,r))},n.prototype.writeInt16LE=function(t,e,r){L(this,t,e,!0,r)},n.prototype.writeInt16BE=function(t,e,r){L(this,t,e,!1,r)},n.prototype.writeInt32LE=function(t,e,r){T(this,t,e,!0,r)},n.prototype.writeInt32BE=function(t,e,r){T(this,t,e,!1,r)},n.prototype.writeFloatLE=function(t,e,r){x(this,t,e,!0,r)},n.prototype.writeFloatBE=function(t,e,r){x(this,t,e,!1,r)},n.prototype.writeDoubleLE=function(t,e,r){I(this,t,e,!0,r)},n.prototype.writeDoubleBE=function(t,e,r){I(this,t,e,!1,r)},n.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),"string"==typeof t&&(t=t.charCodeAt(0)),J("number"==typeof t&&!isNaN(t),"value is not a number"),J(r>=e,"end < start"),r!==e&&0!==this.length){J(e>=0&&e<this.length,"start out of bounds"),J(r>=0&&r<=this.length,"end out of bounds");for(var n=e;r>n;n++)this[n]=t}},n.prototype.inspect=function(){for(var t=[],e=this.length,n=0;e>n;n++)if(t[n]=R(this[n]),n===r.INSPECT_MAX_BYTES){t[n+1]="...";break}return"<Buffer "+t.join(" ")+">"},n.prototype.toArrayBuffer=function(){if("function"==typeof Uint8Array){if(n._useTypedArrays)return new n(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;r>e;e+=1)t[e]=this[e];return t.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var H=n.prototype},{"base64-js":7,ieee754:8}],7:[function(t,e,r){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function r(t){var e=t.charCodeAt(0);return e===s?62:e===u?63:c>e?-1:c+10>e?e-c+26+26:l+26>e?e-l:h+26>e?e-h+26:void 0}function i(t){function e(t){c[l++]=t}var n,i,o,s,u,c;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var h=t.length;u="="===t.charAt(h-2)?2:"="===t.charAt(h-1)?1:0,c=new a(3*t.length/4-u),o=u>0?t.length-4:t.length;var l=0;for(n=0,i=0;o>n;n+=4,i+=3)s=r(t.charAt(n))<<18|r(t.charAt(n+1))<<12|r(t.charAt(n+2))<<6|r(t.charAt(n+3)),e((16711680&s)>>16),e((65280&s)>>8),e(255&s);return 2===u?(s=r(t.charAt(n))<<2|r(t.charAt(n+1))>>4,e(255&s)):1===u&&(s=r(t.charAt(n))<<10|r(t.charAt(n+1))<<4|r(t.charAt(n+2))>>2,e(s>>8&255),
e(255&s)),c}function o(t){function e(t){return n.charAt(t)}function r(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,a,s=t.length%3,u="";for(i=0,a=t.length-s;a>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],u+=r(o);switch(s){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var a="undefined"!=typeof Uint8Array?Uint8Array:Array,s=("0".charCodeAt(0),"+".charCodeAt(0)),u="/".charCodeAt(0),c="0".charCodeAt(0),h="a".charCodeAt(0),l="A".charCodeAt(0);e.exports.toByteArray=i,e.exports.fromByteArray=o}()},{}],8:[function(t,e,r){r.read=function(t,e,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,h=-7,l=r?i-1:0,f=r?-1:1,g=t[e+l];for(l+=f,o=g&(1<<-h)-1,g>>=-h,h+=s;h>0;o=256*o+t[e+l],l+=f,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=n;h>0;a=256*a+t[e+l],l+=f,h-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:(g?-1:1)*(1/0);a+=Math.pow(2,n),o-=c}return(g?-1:1)*a*Math.pow(2,o-n)},r.write=function(t,e,r,n,i,o){var a,s,u,c=8*o-i-1,h=(1<<c)-1,l=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:o-1,d=n?1:-1,p=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+l>=1?f/u:f*Math.pow(2,1-l),e*u>=2&&(a++,u/=2),a+l>=h?(s=0,a=h):a+l>=1?(s=(e*u-1)*Math.pow(2,i),a+=l):(s=e*Math.pow(2,l-1)*Math.pow(2,i),a=0));i>=8;t[r+g]=255&s,g+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[r+g]=255&a,g+=d,a/=256,c-=8);t[r+g-d]|=128*p}},{}],9:[function(t,e,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function a(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!o(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,r,n,o,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length))throw e=arguments[1],e instanceof Error?e:TypeError('Uncaught, unspecified "error" event.');if(r=this._events[t],s(r))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),u=1;n>u;u++)o[u-1]=arguments[u];r.apply(this,o)}else if(a(r)){for(n=arguments.length,o=new Array(n-1),u=1;n>u;u++)o[u-1]=arguments[u];for(c=r.slice(),n=c.length,u=0;n>u;u++)c[u].apply(this,o)}return!0},n.prototype.addListener=function(t,e){var r;if(!i(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned){var r;r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var n=!1;return r.listener=e,this.on(t,r),this},n.prototype.removeListener=function(t,e){var r,n,o,s;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],o=r.length,n=-1,r===e||i(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(r)){for(s=o;s-->0;)if(r[s]===e||r[s].listener&&r[s].listener===e){n=s;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],i(r))this.removeListener(t,r);else for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.listenerCount=function(t,e){var r;return r=t._events&&t._events[e]?i(t._events[e])?1:t._events[e].length:0}},{}],10:[function(t,e,r){var n=e.exports={};n.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var r=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(t){r.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],11:[function(t,e,r){function n(t){return this instanceof n?(s.call(this,t),u.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new n(t)}function i(){if(!this.allowHalfOpen&&!this._writableState.ended){var t=this;a(function(){t.end()})}}e.exports=n;var o=t("inherits"),a=t("process/browser.js").nextTick,s=t("./readable.js"),u=t("./writable.js");o(n,s),n.prototype.write=u.prototype.write,n.prototype.end=u.prototype.end,n.prototype._write=u.prototype._write},{"./readable.js":15,"./writable.js":17,inherits:19,"process/browser.js":13}],12:[function(t,e,r){function n(){i.call(this)}e.exports=n;var i=t("events").EventEmitter,o=t("inherits");o(n,i),n.Readable=t("./readable.js"),n.Writable=t("./writable.js"),n.Duplex=t("./duplex.js"),n.Transform=t("./transform.js"),n.PassThrough=t("./passthrough.js"),n.Stream=n,n.prototype.pipe=function(t,e){function r(e){t.writable&&!1===t.write(e)&&c.pause&&c.pause()}function n(){c.readable&&c.resume&&c.resume()}function o(){h||(h=!0,t.end())}function a(){h||(h=!0,"function"==typeof t.destroy&&t.destroy())}function s(t){if(u(),0===i.listenerCount(this,"error"))throw t}function u(){c.removeListener("data",r),t.removeListener("drain",n),c.removeListener("end",o),c.removeListener("close",a),c.removeListener("error",s),t.removeListener("error",s),c.removeListener("end",u),c.removeListener("close",u),t.removeListener("close",u)}var c=this;c.on("data",r),t.on("drain",n),t._isStdio||e&&e.end===!1||(c.on("end",o),c.on("close",a));var h=!1;return c.on("error",s),t.on("error",s),c.on("end",u),c.on("close",u),t.on("close",u),t.emit("pipe",c),t}},{"./duplex.js":11,"./passthrough.js":14,"./readable.js":15,"./transform.js":16,"./writable.js":17,events:9,inherits:19}],13:[function(t,e,r){e.exports=t(10)},{}],14:[function(t,e,r){function n(t){return this instanceof n?void i.call(this,t):new n(t)}e.exports=n;var i=t("./transform.js"),o=t("inherits");o(n,i),n.prototype._transform=function(t,e,r){r(null,t)}},{"./transform.js":16,inherits:19}],15:[function(t,e,r){(function(r){function n(e,r){e=e||{};var n=e.highWaterMark;this.highWaterMark=n||0===n?n:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(E||(E=t("string_decoder").StringDecoder),this.decoder=new E(e.encoding),this.encoding=e.encoding)}function i(t){return this instanceof i?(this._readableState=new n(t,this),this.readable=!0,void T.call(this)):new i(t)}function o(t,e,r,n,i){var o=c(e,r);if(o)t.emit("error",o);else if(null===r||void 0===r)e.reading=!1,e.ended||h(t,e);else if(e.objectMode||r&&r.length>0)if(e.ended&&!i){var s=new Error("stream.push() after EOF");t.emit("error",s)}else if(e.endEmitted&&i){var s=new Error("stream.unshift() after end event");t.emit("error",s)}else!e.decoder||i||n||(r=e.decoder.write(r)),e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):(e.reading=!1,e.buffer.push(r)),e.needReadable&&l(t),g(t,e);else i||(e.reading=!1);return a(e)}function a(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function s(t){if(t>=A)t=A;else{t--;for(var e=1;32>e;e<<=1)t|=t>>e;t++}return t}function u(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:isNaN(t)||null===t?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:0>=t?0:(t>e.highWaterMark&&(e.highWaterMark=s(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function c(t,e){var r=null;return x.isBuffer(e)||"string"==typeof e||null===e||void 0===e||t.objectMode||r||(r=new TypeError("Invalid non-string/buffer chunk")),r}function h(t,e){if(e.decoder&&!e.ended){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.length>0?l(t):k(t)}function l(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,e.sync?I(function(){f(t)}):f(t))}function f(t){t.emit("readable")}function g(t,e){e.readingMore||(e.readingMore=!0,I(function(){d(t,e)}))}function d(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}function p(t){return function(){var e=t._readableState;e.awaitDrain--,0===e.awaitDrain&&v(t)}}function v(t){function e(t,e,i){var o=t.write(r);!1===o&&n.awaitDrain++}var r,n=t._readableState;for(n.awaitDrain=0;n.pipesCount&&null!==(r=t.read());)if(1===n.pipesCount?e(n.pipes,0,null):b(n.pipes,e),t.emit("data",r),n.awaitDrain>0)return;return 0===n.pipesCount?(n.flowing=!1,void(L.listenerCount(t,"data")>0&&y(t))):void(n.ranOut=!0)}function m(){this._readableState.ranOut&&(this._readableState.ranOut=!1,v(this))}function y(t,e){var r=t._readableState;if(r.flowing)throw new Error("Cannot switch to old mode now.");var n=e||!1,i=!1;t.readable=!0,t.pipe=T.prototype.pipe,t.on=t.addListener=T.prototype.on,t.on("readable",function(){i=!0;for(var e;!n&&null!==(e=t.read());)t.emit("data",e);null===e&&(i=!1,t._readableState.needReadable=!0)}),t.pause=function(){n=!0,this.emit("pause")},t.resume=function(){n=!1,i?I(function(){t.emit("readable")}):this.read(0),this.emit("resume")},t.emit("readable")}function w(t,e){var r,n=e.buffer,i=e.length,o=!!e.decoder,a=!!e.objectMode;if(0===n.length)return null;if(0===i)r=null;else if(a)r=n.shift();else if(!t||t>=i)r=o?n.join(""):x.concat(n,i),n.length=0;else if(t<n[0].length){var s=n[0];r=s.slice(0,t),n[0]=s.slice(t)}else if(t===n[0].length)r=n.shift();else{r=o?"":new x(t);for(var u=0,c=0,h=n.length;h>c&&t>u;c++){var s=n[0],l=Math.min(t-u,s.length);o?r+=s.slice(0,l):s.copy(r,u,0,l),l<s.length?n[0]=s.slice(l):n.shift(),u+=l}}return r}function k(t){var e=t._readableState;if(e.length>0)throw new Error("endReadable called on non-empty stream");!e.endEmitted&&e.calledRead&&(e.ended=!0,I(function(){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}))}function b(t,e){for(var r=0,n=t.length;n>r;r++)e(t[r],r)}function _(t,e){for(var r=0,n=t.length;n>r;r++)if(t[r]===e)return r;return-1}e.exports=i,i.ReadableState=n;var E,L=t("events").EventEmitter,T=t("./index.js"),x=t("buffer").Buffer,I=t("process/browser.js").nextTick,S=t("inherits");S(i,T),i.prototype.push=function(t,e){var r=this._readableState;return"string"!=typeof t||r.objectMode||(e=e||r.defaultEncoding,e!==r.encoding&&(t=new x(t,e),e="")),o(this,r,t,e,!1)},i.prototype.unshift=function(t){var e=this._readableState;return o(this,e,t,"",!0)},i.prototype.setEncoding=function(e){E||(E=t("string_decoder").StringDecoder),this._readableState.decoder=new E(e),this._readableState.encoding=e};var A=8388608;i.prototype.read=function(t){var e=this._readableState;e.calledRead=!0;var r=t;if(("number"!=typeof t||t>0)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return l(this),null;if(t=u(t,e),0===t&&e.ended)return 0===e.length&&k(this),null;var n=e.needReadable;e.length-t<=e.highWaterMark&&(n=!0),(e.ended||e.reading)&&(n=!1),n&&(e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),n&&!e.reading&&(t=u(r,e));var i;return i=t>0?w(t,e):null,null===i&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),e.ended&&!e.endEmitted&&0===e.length&&k(this),i},i.prototype._read=function(t){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(t,e){function n(t){t===h&&o()}function i(){t.end()}function o(){t.removeListener("close",s),t.removeListener("finish",u),t.removeListener("drain",d),t.removeListener("error",a),t.removeListener("unpipe",n),h.removeListener("end",i),h.removeListener("end",o),(!t._writableState||t._writableState.needDrain)&&d()}function a(e){c(),0===y&&0===L.listenerCount(t,"error")&&t.emit("error",e)}function s(){t.removeListener("finish",u),c()}function u(){t.removeListener("close",s),c()}function c(){h.unpipe(t)}var h=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=t;break;case 1:l.pipes=[l.pipes,t];break;default:l.pipes.push(t)}l.pipesCount+=1;var f=(!e||e.end!==!1)&&t!==r.stdout&&t!==r.stderr,g=f?i:o;l.endEmitted?I(g):h.once("end",g),t.on("unpipe",n);var d=p(h);t.on("drain",d);var y=L.listenerCount(t,"error");return t.once("error",a),t.once("close",s),t.once("finish",u),t.emit("pipe",h),l.flowing||(this.on("readable",m),l.flowing=!0,I(function(){v(h)})),t},i.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,this.removeListener("readable",m),e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,this.removeListener("readable",m),e.flowing=!1;for(var i=0;n>i;i++)r[i].emit("unpipe",this);return this}var i=_(e.pipes,t);return-1===i?this:(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},i.prototype.on=function(t,e){var r=T.prototype.on.call(this,t,e);if("data"!==t||this._readableState.flowing||y(this),"readable"===t&&this.readable){var n=this._readableState;n.readableListening||(n.readableListening=!0,n.emittedReadable=!1,n.needReadable=!0,n.reading?n.length&&l(this,n):this.read(0))}return r},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){y(this),this.read(0),this.emit("resume")},i.prototype.pause=function(){y(this,!0),this.emit("pause")},i.prototype.wrap=function(t){var e=this._readableState,r=!1,n=this;t.on("end",function(){if(e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&n.push(t)}n.push(null)}),t.on("data",function(i){if(e.decoder&&(i=e.decoder.write(i)),i&&(e.objectMode||i.length)){var o=n.push(i);o||(r=!0,t.pause())}});for(var i in t)"function"==typeof t[i]&&"undefined"==typeof this[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return b(o,function(e){t.on(e,function(t){return n.emit.apply(n,e,t)})}),n._read=function(e){r&&(r=!1,t.resume())},n},i._fromList=w}).call(this,t("/Users/harth/repos/brain/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"./index.js":12,"/Users/harth/repos/brain/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":10,buffer:6,events:9,inherits:19,"process/browser.js":13,string_decoder:18}],16:[function(t,e,r){function n(t,e){this.afterTransform=function(t,r){return i(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(t,e,r){var n=t._transformState;n.transforming=!1;var i=n.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!==r&&void 0!==r&&t.push(r),i&&i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}function o(t){if(!(this instanceof o))return new o(t);s.call(this,t);var e=(this._transformState=new n(t,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(t){a(e,t)}):a(e)})}function a(t,e){if(e)return t.emit("error",e);var r=t._writableState,n=(t._readableState,t._transformState);if(r.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}e.exports=o;var s=t("./duplex.js"),u=t("inherits");u(o,s),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,s.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,r){throw new Error("not implemented")},o.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0}},{"./duplex.js":11,inherits:19}],17:[function(t,e,r){function n(t,e,r){this.chunk=t,this.encoding=e,this.callback=r}function i(t,e){t=t||{};var r=t.highWaterMark;this.highWaterMark=r||0===r?r:16384,this.objectMode=!!t.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){g(e,t)},this.writecb=null,this.writelen=0,this.buffer=[]}function o(t){return this instanceof o||this instanceof E.Duplex?(this._writableState=new i(t,this),this.writable=!0,void E.call(this)):new o(t)}function a(t,e,r){var n=new Error("write after end");t.emit("error",n),L(function(){r(n)})}function s(t,e,r,n){var i=!0;if(!T.isBuffer(r)&&"string"!=typeof r&&null!==r&&void 0!==r&&!e.objectMode){var o=new TypeError("Invalid non-string/buffer chunk");t.emit("error",o),L(function(){n(o)}),i=!1}return i}function u(t,e,r){return t.objectMode||t.decodeStrings===!1||"string"!=typeof e||(e=new T(e,r)),e}function c(t,e,r,i,o){r=u(e,r,i);var a=e.objectMode?1:r.length;e.length+=a;var s=e.length<e.highWaterMark;return e.needDrain=!s,e.writing?e.buffer.push(new n(r,i,o)):h(t,e,a,r,i,o),s}function h(t,e,r,n,i,o){e.writelen=r,e.writecb=o,e.writing=!0,e.sync=!0,t._write(n,i,e.onwrite),e.sync=!1}function l(t,e,r,n,i){r?L(function(){i(n)}):i(n),t.emit("error",n)}function f(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function g(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(f(r),e)l(t,r,n,e,i);else{var o=m(t,r);o||r.bufferProcessing||!r.buffer.length||v(t,r),n?L(function(){d(t,r,o,i)}):d(t,r,o,i)}}function d(t,e,r,n){r||p(t,e),n(),r&&y(t,e)}function p(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function v(t,e){e.bufferProcessing=!0;for(var r=0;r<e.buffer.length;r++){var n=e.buffer[r],i=n.chunk,o=n.encoding,a=n.callback,s=e.objectMode?1:i.length;if(h(t,e,s,i,o,a),e.writing){r++;break}}e.bufferProcessing=!1,r<e.buffer.length?e.buffer=e.buffer.slice(r):e.buffer.length=0}function m(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function y(t,e){var r=m(t,e);return r&&(e.finished=!0,t.emit("finish")),r}function w(t,e,r){e.ending=!0,y(t,e),r&&(e.finished?L(r):t.once("finish",r)),e.ended=!0}e.exports=o,o.WritableState=i;var k="undefined"!=typeof Uint8Array?function(t){return t instanceof Uint8Array}:function(t){return t&&t.constructor&&"Uint8Array"===t.constructor.name},b="undefined"!=typeof ArrayBuffer?function(t){return t instanceof ArrayBuffer}:function(t){return t&&t.constructor&&"ArrayBuffer"===t.constructor.name},_=t("inherits"),E=t("./index.js"),L=t("process/browser.js").nextTick,T=t("buffer").Buffer;_(o,E),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(t,e,r){var n=this._writableState,i=!1;return"function"==typeof e&&(r=e,e=null),!T.isBuffer(t)&&k(t)&&(t=new T(t)),b(t)&&"undefined"!=typeof Uint8Array&&(t=new T(new Uint8Array(t))),T.isBuffer(t)?e="buffer":e||(e=n.defaultEncoding),"function"!=typeof r&&(r=function(){}),n.ended?a(this,n,r):s(this,n,t,r)&&(i=c(this,n,t,e,r)),i},o.prototype._write=function(t,e,r){r(new Error("not implemented"))},o.prototype.end=function(t,e,r){var n=this._writableState;"function"==typeof t?(r=t,t=null,e=null):"function"==typeof e&&(r=e,e=null),"undefined"!=typeof t&&null!==t&&this.write(t,e),n.ending||n.finished||w(this,n,r)}},{"./index.js":12,buffer:6,inherits:19,"process/browser.js":13}],18:[function(t,e,r){function n(t){if(t&&!s.isEncoding(t))throw new Error("Unknown encoding: "+t)}function i(t){return t.toString(this.encoding)}function o(t){var e=this.charReceived=t.length%2;return this.charLength=e?2:0,e}function a(t){var e=this.charReceived=t.length%3;return this.charLength=e?3:0,e}var s=t("buffer").Buffer,u=r.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),n(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:return void(this.write=i)}this.charBuffer=new s(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(t){for(var e="",r=0;this.charLength;){var n=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,r,n),this.charReceived+=n-r,r=n,this.charReceived<this.charLength)return"";e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var i=e.charCodeAt(e.length-1);if(!(i>=55296&&56319>=i)){if(this.charReceived=this.charLength=0,n==t.length)return e;t=t.slice(n,t.length);break}this.charLength+=this.surrogateSize,e=""}var o=this.detectIncompleteChar(t),a=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-o,a),this.charReceived=o,a-=o),e+=t.toString(this.encoding,0,a);var a=e.length-1,i=e.charCodeAt(a);if(i>=55296&&56319>=i){var s=this.surrogateSize;return this.charLength+=s,this.charReceived+=s,this.charBuffer.copy(this.charBuffer,s,0,s),this.charBuffer.write(e.charAt(e.length-1),this.encoding),e.substring(0,a)}return e},u.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var r=t[t.length-e];if(1==e&&r>>5==6){this.charLength=2;break}if(2>=e&&r>>4==14){this.charLength=3;break}if(3>=e&&r>>3==30){this.charLength=4;break}}return e},u.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;e+=n.slice(0,r).toString(i)}return e}},{buffer:6}],19:[function(t,e,r){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],20:[function(t,e,r){(function(){var t=this,n=t._,i={},o=Array.prototype,a=Object.prototype,s=Function.prototype,u=o.push,c=o.slice,h=o.concat,l=a.toString,f=a.hasOwnProperty,g=o.forEach,d=o.map,p=o.reduce,v=o.reduceRight,m=o.filter,y=o.every,w=o.some,k=o.indexOf,b=o.lastIndexOf,_=Array.isArray,E=Object.keys,L=s.bind,T=function(t){return t instanceof T?t:this instanceof T?void(this._wrapped=t):new T(t)};"undefined"!=typeof r?("undefined"!=typeof e&&e.exports&&(r=e.exports=T),r._=T):t._=T,T.VERSION="1.6.0";var x=T.each=T.forEach=function(t,e,r){if(null==t)return t;if(g&&t.forEach===g)t.forEach(e,r);else if(t.length===+t.length){for(var n=0,o=t.length;o>n;n++)if(e.call(r,t[n],n,t)===i)return}else for(var a=T.keys(t),n=0,o=a.length;o>n;n++)if(e.call(r,t[a[n]],a[n],t)===i)return;return t};T.map=T.collect=function(t,e,r){var n=[];return null==t?n:d&&t.map===d?t.map(e,r):(x(t,function(t,i,o){n.push(e.call(r,t,i,o))}),n)};var I="Reduce of empty array with no initial value";T.reduce=T.foldl=T.inject=function(t,e,r,n){var i=arguments.length>2;if(null==t&&(t=[]),p&&t.reduce===p)return n&&(e=T.bind(e,n)),i?t.reduce(e,r):t.reduce(e);if(x(t,function(t,o,a){i?r=e.call(n,r,t,o,a):(r=t,i=!0)}),!i)throw new TypeError(I);return r},T.reduceRight=T.foldr=function(t,e,r,n){var i=arguments.length>2;if(null==t&&(t=[]),v&&t.reduceRight===v)return n&&(e=T.bind(e,n)),i?t.reduceRight(e,r):t.reduceRight(e);var o=t.length;if(o!==+o){var a=T.keys(t);o=a.length}if(x(t,function(s,u,c){u=a?a[--o]:--o,i?r=e.call(n,r,t[u],u,c):(r=t[u],i=!0)}),!i)throw new TypeError(I);return r},T.find=T.detect=function(t,e,r){var n;return S(t,function(t,i,o){return e.call(r,t,i,o)?(n=t,!0):void 0}),n},T.filter=T.select=function(t,e,r){var n=[];return null==t?n:m&&t.filter===m?t.filter(e,r):(x(t,function(t,i,o){e.call(r,t,i,o)&&n.push(t)}),n)},T.reject=function(t,e,r){return T.filter(t,function(t,n,i){return!e.call(r,t,n,i)},r)},T.every=T.all=function(t,e,r){e||(e=T.identity);var n=!0;return null==t?n:y&&t.every===y?t.every(e,r):(x(t,function(t,o,a){return(n=n&&e.call(r,t,o,a))?void 0:i}),!!n)};var S=T.some=T.any=function(t,e,r){e||(e=T.identity);var n=!1;return null==t?n:w&&t.some===w?t.some(e,r):(x(t,function(t,o,a){return n||(n=e.call(r,t,o,a))?i:void 0}),!!n)};T.contains=T.include=function(t,e){return null==t?!1:k&&t.indexOf===k?-1!=t.indexOf(e):S(t,function(t){return t===e})},T.invoke=function(t,e){var r=c.call(arguments,2),n=T.isFunction(e);return T.map(t,function(t){return(n?e:t[e]).apply(t,r)})},T.pluck=function(t,e){return T.map(t,T.property(e))},T.where=function(t,e){return T.filter(t,T.matches(e))},T.findWhere=function(t,e){return T.find(t,T.matches(e))},T.max=function(t,e,r){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var n=-(1/0),i=-(1/0);return x(t,function(t,o,a){var s=e?e.call(r,t,o,a):t;s>i&&(n=t,i=s)}),n},T.min=function(t,e,r){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var n=1/0,i=1/0;return x(t,function(t,o,a){var s=e?e.call(r,t,o,a):t;i>s&&(n=t,i=s)}),n},T.shuffle=function(t){var e,r=0,n=[];return x(t,function(t){e=T.random(r++),n[r-1]=n[e],n[e]=t}),n},T.sample=function(t,e,r){return null==e||r?(t.length!==+t.length&&(t=T.values(t)),t[T.random(t.length-1)]):T.shuffle(t).slice(0,Math.max(0,e))};var A=function(t){return null==t?T.identity:T.isFunction(t)?t:T.property(t)};T.sortBy=function(t,e,r){return e=A(e),T.pluck(T.map(t,function(t,n,i){return{value:t,index:n,criteria:e.call(r,t,n,i)}}).sort(function(t,e){var r=t.criteria,n=e.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(n>r||void 0===n)return-1}return t.index-e.index}),"value")};var C=function(t){return function(e,r,n){var i={};return r=A(r),x(e,function(o,a){var s=r.call(n,o,a,e);t(i,s,o)}),i}};T.groupBy=C(function(t,e,r){T.has(t,e)?t[e].push(r):t[e]=[r]}),T.indexBy=C(function(t,e,r){t[e]=r}),T.countBy=C(function(t,e){T.has(t,e)?t[e]++:t[e]=1}),T.sortedIndex=function(t,e,r,n){r=A(r);for(var i=r.call(n,e),o=0,a=t.length;a>o;){var s=o+a>>>1;r.call(n,t[s])<i?o=s+1:a=s}return o},T.toArray=function(t){return t?T.isArray(t)?c.call(t):t.length===+t.length?T.map(t,T.identity):T.values(t):[]},T.size=function(t){return null==t?0:t.length===+t.length?t.length:T.keys(t).length},T.first=T.head=T.take=function(t,e,r){return null==t?void 0:null==e||r?t[0]:0>e?[]:c.call(t,0,e)},T.initial=function(t,e,r){return c.call(t,0,t.length-(null==e||r?1:e))},T.last=function(t,e,r){return null==t?void 0:null==e||r?t[t.length-1]:c.call(t,Math.max(t.length-e,0))},T.rest=T.tail=T.drop=function(t,e,r){return c.call(t,null==e||r?1:e)},T.compact=function(t){return T.filter(t,T.identity)};var M=function(t,e,r){return e&&T.every(t,T.isArray)?h.apply(r,t):(x(t,function(t){T.isArray(t)||T.isArguments(t)?e?u.apply(r,t):M(t,e,r):r.push(t)}),r)};T.flatten=function(t,e){return M(t,e,[])},T.without=function(t){return T.difference(t,c.call(arguments,1))},T.partition=function(t,e){var r=[],n=[];return x(t,function(t){(e(t)?r:n).push(t)}),[r,n]},T.uniq=T.unique=function(t,e,r,n){T.isFunction(e)&&(n=r,r=e,e=!1);var i=r?T.map(t,r,n):t,o=[],a=[];return x(i,function(r,n){(e?n&&a[a.length-1]===r:T.contains(a,r))||(a.push(r),o.push(t[n]))}),o},T.union=function(){return T.uniq(T.flatten(arguments,!0))},T.intersection=function(t){var e=c.call(arguments,1);return T.filter(T.uniq(t),function(t){return T.every(e,function(e){return T.contains(e,t)})})},T.difference=function(t){var e=h.apply(o,c.call(arguments,1));return T.filter(t,function(t){return!T.contains(e,t)})},T.zip=function(){for(var t=T.max(T.pluck(arguments,"length").concat(0)),e=new Array(t),r=0;t>r;r++)e[r]=T.pluck(arguments,""+r);return e},T.object=function(t,e){if(null==t)return{};for(var r={},n=0,i=t.length;i>n;n++)e?r[t[n]]=e[n]:r[t[n][0]]=t[n][1];return r},T.indexOf=function(t,e,r){if(null==t)return-1;var n=0,i=t.length;if(r){if("number"!=typeof r)return n=T.sortedIndex(t,e),t[n]===e?n:-1;n=0>r?Math.max(0,i+r):r}if(k&&t.indexOf===k)return t.indexOf(e,r);for(;i>n;n++)if(t[n]===e)return n;return-1},T.lastIndexOf=function(t,e,r){if(null==t)return-1;var n=null!=r;if(b&&t.lastIndexOf===b)return n?t.lastIndexOf(e,r):t.lastIndexOf(e);for(var i=n?r:t.length;i--;)if(t[i]===e)return i;return-1},T.range=function(t,e,r){arguments.length<=1&&(e=t||0,t=0),r=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/r),0),i=0,o=new Array(n);n>i;)o[i++]=t,t+=r;return o};var j=function(){};T.bind=function(t,e){var r,n;if(L&&t.bind===L)return L.apply(t,c.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return r=c.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,r.concat(c.call(arguments)));j.prototype=t.prototype;var i=new j;j.prototype=null;var o=t.apply(i,r.concat(c.call(arguments)));return Object(o)===o?o:i}},T.partial=function(t){var e=c.call(arguments,1);return function(){for(var r=0,n=e.slice(),i=0,o=n.length;o>i;i++)n[i]===T&&(n[i]=arguments[r++]);for(;r<arguments.length;)n.push(arguments[r++]);return t.apply(this,n)}},T.bindAll=function(t){var e=c.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return x(e,function(e){t[e]=T.bind(t[e],t)}),t},T.memoize=function(t,e){var r={};return e||(e=T.identity),function(){var n=e.apply(this,arguments);return T.has(r,n)?r[n]:r[n]=t.apply(this,arguments)}},T.delay=function(t,e){var r=c.call(arguments,2);return setTimeout(function(){return t.apply(null,r)},e)},T.defer=function(t){return T.delay.apply(T,[t,1].concat(c.call(arguments,1)))},T.throttle=function(t,e,r){var n,i,o,a=null,s=0;r||(r={});var u=function(){s=r.leading===!1?0:T.now(),a=null,o=t.apply(n,i),n=i=null};return function(){var c=T.now();s||r.leading!==!1||(s=c);var h=e-(c-s);
return n=this,i=arguments,0>=h?(clearTimeout(a),a=null,s=c,o=t.apply(n,i),n=i=null):a||r.trailing===!1||(a=setTimeout(u,h)),o}},T.debounce=function(t,e,r){var n,i,o,a,s,u=function(){var c=T.now()-a;e>c?n=setTimeout(u,e-c):(n=null,r||(s=t.apply(o,i),o=i=null))};return function(){o=this,i=arguments,a=T.now();var c=r&&!n;return n||(n=setTimeout(u,e)),c&&(s=t.apply(o,i),o=i=null),s}},T.once=function(t){var e,r=!1;return function(){return r?e:(r=!0,e=t.apply(this,arguments),t=null,e)}},T.wrap=function(t,e){return T.partial(e,t)},T.compose=function(){var t=arguments;return function(){for(var e=arguments,r=t.length-1;r>=0;r--)e=[t[r].apply(this,e)];return e[0]}},T.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},T.keys=function(t){if(!T.isObject(t))return[];if(E)return E(t);var e=[];for(var r in t)T.has(t,r)&&e.push(r);return e},T.values=function(t){for(var e=T.keys(t),r=e.length,n=new Array(r),i=0;r>i;i++)n[i]=t[e[i]];return n},T.pairs=function(t){for(var e=T.keys(t),r=e.length,n=new Array(r),i=0;r>i;i++)n[i]=[e[i],t[e[i]]];return n},T.invert=function(t){for(var e={},r=T.keys(t),n=0,i=r.length;i>n;n++)e[t[r[n]]]=r[n];return e},T.functions=T.methods=function(t){var e=[];for(var r in t)T.isFunction(t[r])&&e.push(r);return e.sort()},T.extend=function(t){return x(c.call(arguments,1),function(e){if(e)for(var r in e)t[r]=e[r]}),t},T.pick=function(t){var e={},r=h.apply(o,c.call(arguments,1));return x(r,function(r){r in t&&(e[r]=t[r])}),e},T.omit=function(t){var e={},r=h.apply(o,c.call(arguments,1));for(var n in t)T.contains(r,n)||(e[n]=t[n]);return e},T.defaults=function(t){return x(c.call(arguments,1),function(e){if(e)for(var r in e)void 0===t[r]&&(t[r]=e[r])}),t},T.clone=function(t){return T.isObject(t)?T.isArray(t)?t.slice():T.extend({},t):t},T.tap=function(t,e){return e(t),t};var O=function(t,e,r,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof T&&(t=t._wrapped),e instanceof T&&(e=e._wrapped);var i=l.call(t);if(i!=l.call(e))return!1;switch(i){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=r.length;o--;)if(r[o]==t)return n[o]==e;var a=t.constructor,s=e.constructor;if(a!==s&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1;r.push(t),n.push(e);var u=0,c=!0;if("[object Array]"==i){if(u=t.length,c=u==e.length)for(;u--&&(c=O(t[u],e[u],r,n)););}else{for(var h in t)if(T.has(t,h)&&(u++,!(c=T.has(e,h)&&O(t[h],e[h],r,n))))break;if(c){for(h in e)if(T.has(e,h)&&!u--)break;c=!u}}return r.pop(),n.pop(),c};T.isEqual=function(t,e){return O(t,e,[],[])},T.isEmpty=function(t){if(null==t)return!0;if(T.isArray(t)||T.isString(t))return 0===t.length;for(var e in t)if(T.has(t,e))return!1;return!0},T.isElement=function(t){return!(!t||1!==t.nodeType)},T.isArray=_||function(t){return"[object Array]"==l.call(t)},T.isObject=function(t){return t===Object(t)},x(["Arguments","Function","String","Number","Date","RegExp"],function(t){T["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),T.isArguments(arguments)||(T.isArguments=function(t){return!(!t||!T.has(t,"callee"))}),"function"!=typeof/./&&(T.isFunction=function(t){return"function"==typeof t}),T.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},T.isNaN=function(t){return T.isNumber(t)&&t!=+t},T.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==l.call(t)},T.isNull=function(t){return null===t},T.isUndefined=function(t){return void 0===t},T.has=function(t,e){return f.call(t,e)},T.noConflict=function(){return t._=n,this},T.identity=function(t){return t},T.constant=function(t){return function(){return t}},T.property=function(t){return function(e){return e[t]}},T.matches=function(t){return function(e){if(e===t)return!0;for(var r in t)if(t[r]!==e[r])return!1;return!0}},T.times=function(t,e,r){for(var n=Array(Math.max(0,t)),i=0;t>i;i++)n[i]=e.call(r,i);return n},T.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},T.now=Date.now||function(){return(new Date).getTime()};var R={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};R.unescape=T.invert(R.escape);var B={escape:new RegExp("["+T.keys(R.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(R.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(t){T[t]=function(e){return null==e?"":(""+e).replace(B[t],function(e){return R[t][e]})}}),T.result=function(t,e){if(null==t)return void 0;var r=t[e];return T.isFunction(r)?r.call(t):r},T.mixin=function(t){x(T.functions(t),function(e){var r=T[e]=t[e];T.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),P.call(this,r.apply(T,t))}})};var D=0;T.uniqueId=function(t){var e=++D+"";return t?t+e:e},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(t,e,r){var n;r=T.defaults({},r,T.templateSettings);var i=new RegExp([(r.escape||N).source,(r.interpolate||N).source,(r.evaluate||N).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(i,function(e,r,n,i,s){return a+=t.slice(o,s).replace(F,function(t){return"\\"+U[t]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),i&&(a+="';\n"+i+"\n__p+='"),o=s+e.length,e}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(r.variable||"obj","_",a)}catch(s){throw s.source=a,s}if(e)return n(e,T);var u=function(t){return n.call(this,t,T)};return u.source="function("+(r.variable||"obj")+"){\n"+a+"}",u},T.chain=function(t){return T(t).chain()};var P=function(t){return this._chain?T(t).chain():t};T.mixin(T),x(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];T.prototype[t]=function(){var r=this._wrapped;return e.apply(r,arguments),"shift"!=t&&"splice"!=t||0!==r.length||delete r[0],P.call(this,r)}}),x(["concat","join","slice"],function(t){var e=o[t];T.prototype[t]=function(){return P.call(this,e.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return T})}).call(this)},{}]},{},[1]),!function(t){t.tracking=t.tracking||{},tracking.inherits=function(t,e){function r(){}r.prototype=e.prototype,t.superClass_=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.base=function(t,r){var n=Array.prototype.slice.call(arguments,2);return e.prototype[r].apply(t,n)}},tracking.initUserMedia_=function(e,r){t.navigator.getUserMedia({video:!0,audio:r.audio},function(r){try{e.src=t.URL.createObjectURL(r)}catch(n){e.src=r}},function(){throw Error("Cannot capture user camera.")})},tracking.isNode=function(t){return t.nodeType||this.isWindow(t)},tracking.isWindow=function(t){return!!(t&&t.alert&&t.document)},tracking.one=function(t,e){return this.isNode(t)?t:(e||document).querySelector(t)},tracking.track=function(t,e,r){if(t=tracking.one(t),!t)throw new Error("Element not found, try a different element or selector.");if(!e)throw new Error("Tracker not specified, try `tracking.track(element, new tracking.FaceTracker())`.");switch(t.nodeName.toLowerCase()){case"canvas":return this.trackCanvas_(t,e,r);case"img":return this.trackImg_(t,e,r);case"video":return r&&r.camera&&this.initUserMedia_(t,r),this.trackVideo_(t,e,r);default:throw new Error("Element not supported, try in a canvas, img, or video.")}},tracking.trackCanvas_=function(t,e){var r=this,n=new tracking.TrackerTask(e);return n.on("run",function(){r.trackCanvasInternal_(t,e)}),n.run()},tracking.trackCanvasInternal_=function(t,e){var r=t.width,n=t.height,i=t.getContext("2d"),o=i.getImageData(0,0,r,n);e.track(o.data,r,n)},tracking.trackImg_=function(t,e){var r=t.width,n=t.height,i=document.createElement("canvas");i.width=r,i.height=n;var o=new tracking.TrackerTask(e);return o.on("run",function(){tracking.Canvas.loadImage(i,t.src,0,0,r,n,function(){tracking.trackCanvasInternal_(i,e)})}),o.run()},tracking.trackVideo_=function(e,r){var n,i,o=document.createElement("canvas"),a=o.getContext("2d"),s=function(){n=e.offsetWidth,i=e.offsetHeight,o.width=n,o.height=i};s(),e.addEventListener("resize",s);var u,c=function(){u=t.requestAnimationFrame(function(){if(e.readyState===e.HAVE_ENOUGH_DATA){try{a.drawImage(e,0,0,n,i)}catch(t){}tracking.trackCanvasInternal_(o,r)}c()})},h=new tracking.TrackerTask(r);return h.on("stop",function(){t.cancelAnimationFrame(u)}),h.on("run",function(){c()}),h.run()},t.URL||(t.URL=t.URL||t.webkitURL||t.msURL||t.oURL),navigator.getUserMedia||(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)}(window),function(){tracking.EventEmitter=function(){},tracking.EventEmitter.prototype.events_=null,tracking.EventEmitter.prototype.addListener=function(t,e){if("function"!=typeof e)throw new TypeError("Listener must be a function");return this.events_||(this.events_={}),this.emit("newListener",t,e),this.events_[t]||(this.events_[t]=[]),this.events_[t].push(e),this},tracking.EventEmitter.prototype.listeners=function(t){return this.events_&&this.events_[t]},tracking.EventEmitter.prototype.emit=function(t){var e=this.listeners(t);if(e){for(var r=Array.prototype.slice.call(arguments,1),n=0;n<e.length;n++)e[n]&&e[n].apply(this,r);return!0}return!1},tracking.EventEmitter.prototype.on=tracking.EventEmitter.prototype.addListener,tracking.EventEmitter.prototype.once=function(t,e){var r=this;r.on(t,function n(){r.removeListener(t,n),e.apply(this,arguments)})},tracking.EventEmitter.prototype.removeAllListeners=function(t){return this.events_?(t?delete this.events_[t]:delete this.events_,this):this},tracking.EventEmitter.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new TypeError("Listener must be a function");if(!this.events_)return this;var r=this.listeners(t);if(Array.isArray(r)){var n=r.indexOf(e);if(0>n)return this;r.splice(n,1)}return this},tracking.EventEmitter.prototype.setMaxListeners=function(){throw new Error("Not implemented")}}(),function(){tracking.Canvas={},tracking.Canvas.loadImage=function(t,e,r,n,i,o,a){var s=this,u=new window.Image;u.onload=function(){var e=t.getContext("2d");t.width=i,t.height=o,e.drawImage(u,r,n,i,o),a&&a.call(s),u=null},u.src=e}}(),function(){tracking.DisjointSet=function(t){if(void 0===t)throw new Error("DisjointSet length not specified.");this.length=t,this.parent=new Uint32Array(t);for(var e=0;t>e;e++)this.parent[e]=e},tracking.DisjointSet.prototype.length=null,tracking.DisjointSet.prototype.parent=null,tracking.DisjointSet.prototype.find=function(t){return this.parent[t]===t?t:this.parent[t]=this.find(this.parent[t])},tracking.DisjointSet.prototype.union=function(t,e){var r=this.find(t),n=this.find(e);this.parent[r]=n}}(),function(){tracking.Image={},tracking.Image.blur=function(t,e,r,n){if(n=Math.abs(n),1>=n)throw new Error("Diameter should be greater than 1.");for(var i=n/2,o=Math.ceil(n)+(1-Math.ceil(n)%2),a=new Float32Array(o),s=(i+.5)/3,u=s*s,c=1/Math.sqrt(2*Math.PI*u),h=-1/(2*s*s),l=0,f=Math.floor(o/2),g=0;o>g;g++){var d=g-f,p=c*Math.exp(d*d*h);a[g]=p,l+=p}for(var v=0;v<a.length;v++)a[v]/=l;return this.separableConvolve(t,e,r,a,a,!1)},tracking.Image.computeIntegralImage=function(t,e,r,n,i,o,a){if(arguments.length<4)throw new Error("You should specify at least one output array in the order: sum, square, tilted, sobel.");var s;a&&(s=tracking.Image.sobel(t,e,r));for(var u=0;r>u;u++)for(var c=0;e>c;c++){var h=u*e*4+4*c,l=~~(.299*t[h]+.587*t[h+1]+.114*t[h+2]);if(n&&this.computePixelValueSAT_(n,e,u,c,l),i&&this.computePixelValueSAT_(i,e,u,c,l*l),o){var f=h-4*e,g=~~(.299*t[f]+.587*t[f+1]+.114*t[f+2]);this.computePixelValueRSAT_(o,e,u,c,l,g||0)}a&&this.computePixelValueSAT_(a,e,u,c,s[h])}},tracking.Image.computePixelValueRSAT_=function(t,e,r,n,i,o){var a=r*e+n;t[a]=(t[a-e-1]||0)+(t[a-e+1]||0)-(t[a-e-e]||0)+i+o},tracking.Image.computePixelValueSAT_=function(t,e,r,n,i){var o=r*e+n;t[o]=(t[o-e]||0)+(t[o-1]||0)+i-(t[o-e-1]||0)},tracking.Image.grayscale=function(t,e,r,n){for(var i=new Uint8ClampedArray(n?t.length:t.length>>2),o=0,a=0,s=0;r>s;s++)for(var u=0;e>u;u++){var c=.299*t[a]+.587*t[a+1]+.114*t[a+2];i[o++]=c,n&&(i[o++]=c,i[o++]=c,i[o++]=t[a+3]),a+=4}return i},tracking.Image.horizontalConvolve=function(t,e,r,n,i){for(var o=n.length,a=Math.floor(o/2),s=new Float32Array(e*r*4),u=i?1:0,c=0;r>c;c++)for(var h=0;e>h;h++){for(var l=c,f=h,g=4*(c*e+h),d=0,p=0,v=0,m=0,y=0;o>y;y++){var w=l,k=Math.min(e-1,Math.max(0,f+y-a)),b=4*(w*e+k),_=n[y];d+=t[b]*_,p+=t[b+1]*_,v+=t[b+2]*_,m+=t[b+3]*_}s[g]=d,s[g+1]=p,s[g+2]=v,s[g+3]=m+u*(255-m)}return s},tracking.Image.verticalConvolve=function(t,e,r,n,i){for(var o=n.length,a=Math.floor(o/2),s=new Float32Array(e*r*4),u=i?1:0,c=0;r>c;c++)for(var h=0;e>h;h++){for(var l=c,f=h,g=4*(c*e+h),d=0,p=0,v=0,m=0,y=0;o>y;y++){var w=Math.min(r-1,Math.max(0,l+y-a)),k=f,b=4*(w*e+k),_=n[y];d+=t[b]*_,p+=t[b+1]*_,v+=t[b+2]*_,m+=t[b+3]*_}s[g]=d,s[g+1]=p,s[g+2]=v,s[g+3]=m+u*(255-m)}return s},tracking.Image.separableConvolve=function(t,e,r,n,i,o){var a=this.verticalConvolve(t,e,r,i,o);return this.horizontalConvolve(a,e,r,n,o)},tracking.Image.sobel=function(t,e,r){t=this.grayscale(t,e,r,!0);for(var n=new Float32Array(e*r*4),i=new Float32Array([-1,0,1]),o=new Float32Array([1,2,1]),a=this.separableConvolve(t,e,r,i,o),s=this.separableConvolve(t,e,r,o,i),u=0;u<n.length;u+=4){var c=a[u],h=s[u],l=Math.sqrt(h*h+c*c);n[u]=l,n[u+1]=l,n[u+2]=l,n[u+3]=255}return n}}(),function(){tracking.ViolaJones={},tracking.ViolaJones.REGIONS_OVERLAP=.5,tracking.ViolaJones.classifiers={},tracking.ViolaJones.detect=function(t,e,r,n,i,o,a,s){var u,c=0,h=[],l=new Int32Array(e*r),f=new Int32Array(e*r),g=new Int32Array(e*r);a>0&&(u=new Int32Array(e*r)),tracking.Image.computeIntegralImage(t,e,r,l,f,g,u);for(var d=s[0],p=s[1],v=n*i,m=v*d|0,y=v*p|0;e>m&&r>y;){for(var w=v*o+.5|0,k=0;r-y>k;k+=w)for(var b=0;e-m>b;b+=w)a>0&&this.isTriviallyExcluded(a,u,k,b,e,m,y)||this.evalStages_(s,l,f,g,k,b,e,m,y,v)&&(h[c++]={width:m,height:y,x:b,y:k});v*=i,m=v*d|0,y=v*p|0}return this.mergeRectangles_(h)},tracking.ViolaJones.isTriviallyExcluded=function(t,e,r,n,i,o,a){var s=r*i+n,u=s+o,c=s+a*i,h=c+o,l=(e[s]-e[u]-e[c]+e[h])/(o*a*255);return t>l?!0:!1},tracking.ViolaJones.evalStages_=function(t,e,r,n,i,o,a,s,u,c){var h=1/(s*u),l=i*a+o,f=l+s,g=l+u*a,d=g+s,p=(e[l]-e[f]-e[g]+e[d])*h,v=(r[l]-r[f]-r[g]+r[d])*h-p*p,m=1;v>0&&(m=Math.sqrt(v));for(var y=t.length,w=2;y>w;){for(var k=0,b=t[w++],_=t[w++];_--;){for(var E=0,L=t[w++],T=t[w++],x=0;T>x;x++){var I,S,A,C,M=o+t[w++]*c+.5|0,j=i+t[w++]*c+.5|0,O=t[w++]*c+.5|0,R=t[w++]*c+.5|0,B=t[w++];L?(I=M-R+O+(j+O+R-1)*a,S=M+(j-1)*a,A=M-R+(j+R-1)*a,C=M+O+(j+O-1)*a,E+=(n[I]+n[S]-n[A]-n[C])*B):(I=j*a+M,S=I+O,A=I+R*a,C=A+O,E+=(e[I]-e[S]-e[A]+e[C])*B)}var D=t[w++],N=t[w++],U=t[w++];k+=D*m>E*h?N:U}if(b>k)return!1}return!0},tracking.ViolaJones.mergeRectangles_=function(t){for(var e=new tracking.DisjointSet(t.length),r=0;r<t.length;r++)for(var n=t[r],i=0;i<t.length;i++){var o=t[i];if(tracking.Math.intersectRect(n.x,n.y,n.x+n.width,n.y+n.height,o.x,o.y,o.x+o.width,o.y+o.height)){var a=Math.max(n.x,o.x),s=Math.max(n.y,o.y),u=Math.min(n.x+n.width,o.x+o.width),c=Math.min(n.y+n.height,o.y+o.height),h=(a-u)*(s-c),l=n.width*n.height,f=o.width*o.height;h/(l*(l/f))>=this.REGIONS_OVERLAP&&h/(f*(l/f))>=this.REGIONS_OVERLAP&&e.union(r,i)}}for(var g={},d=0;d<e.length;d++){var p=e.find(d);g[p]?(g[p].total++,g[p].width+=t[d].width,g[p].height+=t[d].height,g[p].x+=t[d].x,g[p].y+=t[d].y):g[p]={total:1,width:t[d].width,height:t[d].height,x:t[d].x,y:t[d].y}}var v=[];return Object.keys(g).forEach(function(t){var e=g[t];v.push({total:e.total,width:e.width/e.total+.5|0,height:e.height/e.total+.5|0,x:e.x/e.total+.5|0,y:e.y/e.total+.5|0})}),v}}(),function(){tracking.Brief={},tracking.Brief.N=512,tracking.Brief.randomImageOffsets_={},tracking.Brief.randomWindowOffsets_=null,tracking.Brief.getDescriptors=function(t,e,r){for(var n=new Int32Array((r.length>>1)*(this.N>>5)),i=0,o=this.getRandomOffsets_(e),a=0,s=0;s<r.length;s+=2)for(var u=e*r[s+1]+r[s],c=0,h=0,l=this.N;l>h;h++)t[o[c++]+u]<t[o[c++]+u]&&(i|=1<<(31&h)),h+1&31||(n[a++]=i,i=0);return n},tracking.Brief.match=function(t,e,r,n){for(var i=t.length>>1,o=r.length>>1,a=new Array(i),s=0;i>s;s++){for(var u=1/0,c=0,h=0;o>h;h++){for(var l=0,f=0,g=this.N>>5;g>f;f++)l+=tracking.Math.hammingWeight(e[s*g+f]^n[h*g+f]);u>l&&(u=l,c=h)}a[s]={index1:s,index2:c,keypoint1:[t[2*s],t[2*s+1]],keypoint2:[r[2*c],r[2*c+1]],confidence:1-u/this.N}}return a},tracking.Brief.reciprocalMatch=function(t,e,r,n){var i=[];if(0===t.length||0===r.length)return i;for(var o=tracking.Brief.match(t,e,r,n),a=tracking.Brief.match(r,n,t,e),s=0;s<o.length;s++)a[o[s].index2].index2===s&&i.push(o[s]);return i},tracking.Brief.getRandomOffsets_=function(t){if(!this.randomWindowOffsets_){for(var e=0,r=new Int32Array(4*this.N),n=0;n<this.N;n++)r[e++]=Math.round(tracking.Math.uniformRandom(-15,16)),r[e++]=Math.round(tracking.Math.uniformRandom(-15,16)),r[e++]=Math.round(tracking.Math.uniformRandom(-15,16)),r[e++]=Math.round(tracking.Math.uniformRandom(-15,16));this.randomWindowOffsets_=r}if(!this.randomImageOffsets_[t]){for(var i=0,o=new Int32Array(2*this.N),a=0;a<this.N;a++)o[i++]=this.randomWindowOffsets_[4*a]*t+this.randomWindowOffsets_[4*a+1],o[i++]=this.randomWindowOffsets_[4*a+2]*t+this.randomWindowOffsets_[4*a+3];this.randomImageOffsets_[t]=o}return this.randomImageOffsets_[t]}}(),function(){tracking.Fast={},tracking.Fast.THRESHOLD=40,tracking.Fast.circles_={},tracking.Fast.findCorners=function(t,e,r,n){var i=this.getCircleOffsets_(e),o=new Int32Array(16),a=[];void 0===n&&(n=this.THRESHOLD);for(var s=3;r-3>s;s++)for(var u=3;e-3>u;u++){for(var c=s*e+u,h=t[c],l=0;16>l;l++)o[l]=t[c+i[l]];this.isCorner(h,o,n)&&(a.push(u,s),u+=3)}return a},tracking.Fast.isBrighter=function(t,e,r){return t-e>r},tracking.Fast.isCorner=function(t,e,r){if(this.isTriviallyExcluded(e,t,r))return!1;for(var n=0;16>n;n++){for(var i=!0,o=!0,a=0;9>a;a++){var s=e[n+a&15];if(!this.isBrighter(t,s,r)&&(o=!1,i===!1))break;if(!this.isDarker(t,s,r)&&(i=!1,o===!1))break}if(o||i)return!0}return!1},tracking.Fast.isDarker=function(t,e,r){return e-t>r},tracking.Fast.isTriviallyExcluded=function(t,e,r){var n=0,i=t[8],o=t[12],a=t[4],s=t[0];return this.isBrighter(s,e,r)&&n++,this.isBrighter(a,e,r)&&n++,this.isBrighter(i,e,r)&&n++,this.isBrighter(o,e,r)&&n++,3>n&&(n=0,this.isDarker(s,e,r)&&n++,this.isDarker(a,e,r)&&n++,this.isDarker(i,e,r)&&n++,this.isDarker(o,e,r)&&n++,3>n)?!0:!1},tracking.Fast.getCircleOffsets_=function(t){if(this.circles_[t])return this.circles_[t];var e=new Int32Array(16);return e[0]=-t-t-t,e[1]=e[0]+1,e[2]=e[1]+t+1,e[3]=e[2]+t+1,e[4]=e[3]+t,e[5]=e[4]+t,e[6]=e[5]+t-1,e[7]=e[6]+t-1,e[8]=e[7]-1,e[9]=e[8]-1,e[10]=e[9]-t-1,e[11]=e[10]-t-1,e[12]=e[11]-t,e[13]=e[12]-t,e[14]=e[13]-t+1,e[15]=e[14]-t+1,this.circles_[t]=e,e}}(),function(){tracking.Math={},tracking.Math.distance=function(t,e,r,n){var i=r-t,o=n-e;return Math.sqrt(i*i+o*o)},tracking.Math.hammingWeight=function(t){return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24},tracking.Math.uniformRandom=function(t,e){return t+Math.random()*(e-t)},tracking.Math.intersectRect=function(t,e,r,n,i,o,a,s){return!(i>r||t>a||o>n||e>s)}}(),function(){tracking.Matrix={},tracking.Matrix.forEach=function(t,e,r,n,i){i=i||1;for(var o=0;r>o;o+=i)for(var a=0;e>a;a+=i){var s=o*e*4+4*a;n.call(this,t[s],t[s+1],t[s+2],t[s+3],s,o,a)}}}(),function(){tracking.EPnP={},tracking.EPnP.solve=function(){}}(),function(){tracking.Tracker=function(){tracking.Tracker.base(this,"constructor")},tracking.inherits(tracking.Tracker,tracking.EventEmitter),tracking.Tracker.prototype.track=function(){}}(),function(){tracking.TrackerTask=function(t){if(tracking.TrackerTask.base(this,"constructor"),!t)throw new Error("Tracker instance not specified.");this.setTracker(t)},tracking.inherits(tracking.TrackerTask,tracking.EventEmitter),tracking.TrackerTask.prototype.tracker_=null,tracking.TrackerTask.prototype.running_=!1,tracking.TrackerTask.prototype.getTracker=function(){return this.tracker_},tracking.TrackerTask.prototype.inRunning=function(){return this.running_},tracking.TrackerTask.prototype.setRunning=function(t){this.running_=t},tracking.TrackerTask.prototype.setTracker=function(t){this.tracker_=t},tracking.TrackerTask.prototype.run=function(){var t=this;return this.inRunning()?void 0:(this.setRunning(!0),this.reemitTrackEvent_=function(e){t.emit("track",e)},this.tracker_.on("track",this.reemitTrackEvent_),this.emit("run"),this)},tracking.TrackerTask.prototype.stop=function(){return this.inRunning()?(this.setRunning(!1),this.emit("stop"),this.tracker_.removeListener("track",this.reemitTrackEvent_),this):void 0}}(),function(){tracking.ColorTracker=function(t){tracking.ColorTracker.base(this,"constructor"),"string"==typeof t&&(t=[t]),t&&(t.forEach(function(t){if(!tracking.ColorTracker.getColor(t))throw new Error('Color not valid, try `new tracking.ColorTracker("magenta")`.')}),this.setColors(t))},tracking.inherits(tracking.ColorTracker,tracking.Tracker),tracking.ColorTracker.knownColors_={},tracking.ColorTracker.neighbours_={},tracking.ColorTracker.registerColor=function(t,e){tracking.ColorTracker.knownColors_[t]=e},tracking.ColorTracker.getColor=function(t){return tracking.ColorTracker.knownColors_[t]},tracking.ColorTracker.prototype.colors=["magenta"],tracking.ColorTracker.prototype.minDimension=20,tracking.ColorTracker.prototype.maxDimension=1/0,tracking.ColorTracker.prototype.minGroupSize=30,tracking.ColorTracker.prototype.calculateDimensions_=function(t,e){for(var r=-1,n=-1,i=1/0,o=1/0,a=0;e>a;a+=2){var s=t[a],u=t[a+1];i>s&&(i=s),s>r&&(r=s),o>u&&(o=u),u>n&&(n=u)}return{width:r-i,height:n-o,x:i,y:o}},tracking.ColorTracker.prototype.getColors=function(){return this.colors},tracking.ColorTracker.prototype.getMinDimension=function(){return this.minDimension},tracking.ColorTracker.prototype.getMaxDimension=function(){return this.maxDimension},tracking.ColorTracker.prototype.getMinGroupSize=function(){return this.minGroupSize},tracking.ColorTracker.prototype.getNeighboursForWidth_=function(t){if(tracking.ColorTracker.neighbours_[t])return tracking.ColorTracker.neighbours_[t];var e=new Int32Array(8);return e[0]=4*-t,e[1]=4*-t+4,e[2]=4,e[3]=4*t+4,e[4]=4*t,e[5]=4*t-4,e[6]=-4,e[7]=4*-t-4,tracking.ColorTracker.neighbours_[t]=e,e},tracking.ColorTracker.prototype.mergeRectangles_=function(t){for(var e,r=[],n=this.getMinDimension(),i=this.getMaxDimension(),o=0;o<t.length;o++){var a=t[o];e=!0;for(var s=o+1;s<t.length;s++){var u=t[s];if(tracking.Math.intersectRect(a.x,a.y,a.x+a.width,a.y+a.height,u.x,u.y,u.x+u.width,u.y+u.height)){e=!1;var c=Math.min(a.x,u.x),h=Math.min(a.y,u.y),l=Math.max(a.x+a.width,u.x+u.width),f=Math.max(a.y+a.height,u.y+u.height);u.height=f-h,u.width=l-c,u.x=c,u.y=h;break}}e&&a.width>=n&&a.height>=n&&a.width<=i&&a.height<=i&&r.push(a)}return r},tracking.ColorTracker.prototype.setColors=function(t){this.colors=t},tracking.ColorTracker.prototype.setMinDimension=function(t){this.minDimension=t},tracking.ColorTracker.prototype.setMaxDimension=function(t){this.maxDimension=t},tracking.ColorTracker.prototype.setMinGroupSize=function(t){this.minGroupSize=t},tracking.ColorTracker.prototype.track=function(t,e,r){var n=this,i=this.getColors();if(!i)throw new Error('Colors not specified, try `new tracking.ColorTracker("magenta")`.');var o=[];i.forEach(function(i){o=o.concat(n.trackColor_(t,e,r,i))}),this.emit("track",{data:o})},tracking.ColorTracker.prototype.trackColor_=function(r,n,i,o){var a,s,u,c,h,l=tracking.ColorTracker.knownColors_[o],f=new Int32Array(r.length>>2),g=new Int8Array(r.length),d=this.getMinGroupSize(),p=this.getNeighboursForWidth_(n),v=new Int32Array(r.length),m=[],y=-4;if(!l)return m;for(var w=0;i>w;w++)for(var k=0;n>k;k++)if(y+=4,!g[y]){for(a=0,h=-1,v[++h]=y,v[++h]=w,v[++h]=k,g[y]=1;h>=0;)if(u=v[h--],s=v[h--],c=v[h--],l(r[c],r[c+1],r[c+2],r[c+3],c,s,u)){f[a++]=u,f[a++]=s;for(var b=0;b<p.length;b++){var _=c+p[b],E=s+t[b],L=u+e[b];!g[_]&&E>=0&&i>E&&L>=0&&n>L&&(v[++h]=_,v[++h]=E,v[++h]=L,g[_]=1)}}if(a>=d){var T=this.calculateDimensions_(f,a);T&&(T.color=o,m.push(T))}}return this.mergeRectangles_(m)},tracking.ColorTracker.registerColor("cyan",function(t,e,r){var n=50,i=70,o=t-0,a=e-255,s=r-255;return e-t>=n&&r-t>=i?!0:6400>o*o+a*a+s*s}),tracking.ColorTracker.registerColor("magenta",function(t,e,r){var n=50,i=t-255,o=e-0,a=r-255;return t-e>=n&&r-e>=n?!0:19600>i*i+o*o+a*a}),tracking.ColorTracker.registerColor("yellow",function(t,e,r){var n=50,i=t-255,o=e-255,a=r-0;return t-r>=n&&e-r>=n?!0:1e4>i*i+o*o+a*a});var t=new Int32Array([-1,-1,0,1,1,1,0,-1]),e=new Int32Array([0,1,1,1,0,-1,-1,-1])}(),function(){tracking.ObjectTracker=function(t){tracking.ObjectTracker.base(this,"constructor"),t&&(Array.isArray(t)||(t=[t]),Array.isArray(t)&&t.forEach(function(e,r){if("string"==typeof e&&(t[r]=tracking.ViolaJones.classifiers[e]),!t[r])throw new Error('Object classifier not valid, try `new tracking.ObjectTracker("face")`.')})),this.setClassifiers(t)},tracking.inherits(tracking.ObjectTracker,tracking.Tracker),tracking.ObjectTracker.prototype.edgesDensity=.2,tracking.ObjectTracker.prototype.initialScale=1,tracking.ObjectTracker.prototype.scaleFactor=1.25,tracking.ObjectTracker.prototype.stepSize=1.5,tracking.ObjectTracker.prototype.getClassifiers=function(){return this.classifiers},tracking.ObjectTracker.prototype.getEdgesDensity=function(){return this.edgesDensity},tracking.ObjectTracker.prototype.getInitialScale=function(){return this.initialScale},tracking.ObjectTracker.prototype.getScaleFactor=function(){return this.scaleFactor},tracking.ObjectTracker.prototype.getStepSize=function(){return this.stepSize},tracking.ObjectTracker.prototype.track=function(t,e,r){var n=this,i=this.getClassifiers();if(!i)throw new Error('Object classifier not specified, try `new tracking.ObjectTracker("face")`.');var o=[];i.forEach(function(i){o=o.concat(tracking.ViolaJones.detect(t,e,r,n.getInitialScale(),n.getScaleFactor(),n.getStepSize(),n.getEdgesDensity(),i))}),this.emit("track",{data:o})},tracking.ObjectTracker.prototype.setClassifiers=function(t){this.classifiers=t},tracking.ObjectTracker.prototype.setEdgesDensity=function(t){this.edgesDensity=t},tracking.ObjectTracker.prototype.setInitialScale=function(t){this.initialScale=t},tracking.ObjectTracker.prototype.setScaleFactor=function(t){this.scaleFactor=t},tracking.ObjectTracker.prototype.setStepSize=function(t){this.stepSize=t}}();