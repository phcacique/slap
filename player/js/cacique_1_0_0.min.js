function getRandomNumber(t,e){return Math.random()*(e-t+1)+t}function animate(){ctx.clearRect(0,0,cw,ch),requestAnimationFrame(animate)}function Shape(t,e,i,n){this.position=null==e||"Point"!=e.classname?new Point:e,this.geometry=null==t||"GenericObject"!=t.constructor.name?new Circle:t,this.color=null==i||"GenericObject"!=t.constructor.name||"Color"!=i.classname&&"Gradient"!=i.classname?null:i,this.lineColor=new Color,this.lineWidth=1,this.scale=1,this.decay=0,this.showPoints=!0,null!=n&&this.setProperties(n),GenericObject.call(this,"Shape")}function Point(t,e){this.x=null==t||isNaN(t)?0:t,this.y=null==e||isNaN(e)?0:e,GenericObject.call(this,"Point")}function Rect(t,e){this.p1=null==t||"Point"!=t.classname?new Point:t,this.p2=null==e||"Point"!=e.classname?new Point(10,0):e,this.m=this.p2.x==this.p1.x?0:(this.p2.y-this.p1.y)/(this.p2.x-this.p1.x),this.n=this.p2.y-this.m*this.p2.x,GenericObject.call(this,"Rect")}function BezierLine(t){this.bezierCurve=t,GenericObject.call(this,"BezierLine")}function Circle(t){this.center=new Point,this.radius=null==t||isNaN(t)?1:t,GenericObject.call(this,"Circle")}function Rectangle(t,e){this.width=null==t||isNaN(t)?1:t,this.height=null==e||isNaN(e)?this.width:e,GenericObject.call(this,"Rectangle")}function Polygon(t,e,i,n){this.isStar=null!=i?i:!1,this.radius=null==t||isNaN(t)?5:t,this.innerRadius=null==n||isNaN(n)?i?this.radius/2:this.radius:n,this.points=null==e||isNaN(e)?5:e,this.circle=new Circle(this.radius),this.innerCircle=new Circle(this.innerRadius),this.points<3&&(this.points=3),GenericObject.call(this,"Polygon")}function Heart(){GenericObject.call(this,"Heart")}function Color(t,e,i,n){this.r=null==t||isNaN(t)?0:t,this.g=null==e||isNaN(e)?0:e,this.b=null==i||isNaN(i)?0:i,this.a=null==n||isNaN(n)?1:n,this.hex=this.toHex(),GenericObject.call(this,"Color")}function Gradient(t,e,i,n){this.rect=null!=e&&"GenericObject"==e.constructor.name&&"Rect"==e.classname?e:new Rect,this.colors=null!=t&&Array.isArray(t)?t:[],this.radius1=null==i||isNaN(i)?0:i,this.radius2=null==n||isNaN(n)?0:n,GenericObject.call(this,"Gradient")}function BezierCurve(t,e,i,n,r){this.startPoint=null!=t?t:new Point(100,200),this.endPoint=null!=n?n:new Point(200,100),this.controlPoint1=null!=e?e:new Point(150,200),this.controlPoint2=null!=i?i:new Point(200,150),null!=r&&this.setProperties(r),GenericObject.call(this,"BezierCurve")}function Vector(t,e,i){this.p1=null!=t&&"GenericObject"==t.constructor.name&&"Point"==t.classname?t:new Point,this.p2=null!=e&&"GenericObject"==e.constructor.name&&"Point"==e.classname?e:new Point,this.rect=new Rect(t,e),this.origin=new Point,GenericObject.call(this,"Vector")}function GenericObject(t){this.classname=t}Shape.prototype=new GenericObject,Shape.prototype.setProperties=function(t){for(var e in t)this[e]=t[e]},Shape.prototype.draw=function(t){if(this.scale>0){var e=t.getContext("2d");t.width,t.height;switch(e.beginPath(),this.lineWidth>0&&(e.strokeStyle="Color"==this.lineColor.classname?this.lineColor.toRGBA():this.lineColor.getGradient(),e.lineWidth=this.lineWidth),null==this.color||"Color"!=this.color.classname&&"Gradient"!=this.color.classname||(e.fillStyle="Color"==this.color.classname?this.color.toRGBA():this.color.getGradient()),this.geometry.classname){case"Circle":e.arc(this.position.x,this.position.y,this.geometry.radius*this.scale,0,2*Math.PI);break;case"Rectangle":e.rect(this.position.x,this.position.y,this.geometry.width*this.scale,this.geometry.height*this.scale);break;case"Rect":e.moveTo(this.position.x,this.position.y),e.lineTo(this.geometry.p2.x*this.scale,this.geometry.p2.y*this.scale);break;case"Heart":for(var r=0;r<2*Math.PI;r+=.05){var o=this.geometry.getPositionByAngle(r);o.multiply(this.scale),o.add(this.position),0==r?e.moveTo(o.x,o.y):e.lineTo(o.x,o.y)}break;case"Polygon":var s=2*Math.PI/this.geometry.points,c=-Math.PI/2;this.geometry.circle.radius*=this.scale,this.geometry.innerCircle.radius*=this.scale;for(var r=0;r<=this.geometry.points;r++){var o=this.geometry.circle.getPositionByAngle(c),a=this.geometry.innerCircle.getPositionByAngle(c-s/2);c+=s,0==r?e.moveTo(this.position.x+o.x,this.position.y+o.y):(this.geometry.isStar&&e.lineTo(this.position.x+a.x,this.position.y+a.y),e.lineTo(this.position.x+o.x,this.position.y+o.y))}break;case"BezierLine":e.strokeStyle=this.lineColor,e.lineWidth=this.lineWidth,e.moveTo(this.geometry.bezierCurve.startPoint.x,this.geometry.bezierCurve.startPoint.y),e.bezierCurveTo(this.geometry.bezierCurve.controlPoint1.x,this.geometry.bezierCurve.controlPoint1.y,this.geometry.bezierCurve.controlPoint2.x,this.geometry.bezierCurve.controlPoint2.y,this.geometry.bezierCurve.endPoint.x,this.geometry.bezierCurve.endPoint.y);break;case"BezierCurve":e.beginPath(),new Shape(new BezierLine(this.geometry.clone())).draw(t),e.beginPath(),new Shape(new Rectangle(8,8),new Point(this.geometry.controlPoint1.x-4,this.geometry.controlPoint1.y-4),new Color(128,201,247,1),{lineWidth:0}).draw(t),e.beginPath(),new Shape(new Rectangle(8,8),new Point(this.geometry.controlPoint2.x-4,this.geometry.controlPoint2.y-4),new Color(128,201,247,1),{lineWidth:0}).draw(t),e.beginPath(),new Shape(new Rect(this.geometry.startPoint.clone(),this.geometry.controlPoint1.clone()),this.geometry.startPoint,new Color(128,201,247,1),{lineWidth:.5,lineColor:new Color(128,201,247,1)}).draw(t),e.beginPath(),new Shape(new Rect(this.geometry.endPoint.clone(),this.geometry.controlPoint2.clone()),this.geometry.endPoint,new Color(128,201,247,1),{lineWidth:.5,lineColor:new Color(128,201,247,1)}).draw(t),e.beginPath(),new Shape(new Circle(5),this.geometry.startPoint.clone(),new Color(247,229,128,1),{lineWidth:0}).draw(t),e.beginPath(),new Shape(new Circle(5),this.geometry.endPoint.clone(),new Color(247,229,128,1),{lineWidth:0}).draw(t),this.lineWidth=0}this.lineWidth>0&&e.stroke(),null!=this.color&&e.fill(),this.scale-=this.decay}},Point.prototype=new GenericObject,Point.prototype.add=function(t){return t.classname!=this.classname?null:(this.x+=t.x,this.y+=t.y,this)},Point.prototype.sub=function(t){return t.classname!=this.classname?null:(this.x-=t.x,this.y-=t.y,this)},Point.prototype.distance=function(t){return t.classname!=this.classname?null:Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},Point.prototype.manhatan=function(t){return t.classname!=this.classname?null:t.x-p1.x+(t.y-p1.y)},Point.prototype.multiply=function(t){return this.x*=t,this.y*=t,this},Point.prototype.isNear=function(t,e){return t.classname!=this.classname?!1:this.x>t.x-e&&this.x<t.x+e&&this.y>t.y-e&&this.y<t.y+e},Rect.prototype=new GenericObject,Rect.prototype.getX=function(t){return null==t||isNaN(t)?null:(t-this.n)/this.m},Rect.prototype.getY=function(t){return null==t||isNaN(t)?null:this.m*t+this.n},Rect.prototype.isParallel=function(t){return t.classname!=this.classname?!1:this.m==t.m},BezierLine.prototype=new GenericObject,Circle.prototype=new GenericObject,Circle.prototype.getPositionByX=function(t){return null==t||isNaN(t)?null:new Point(t,Math.sqrt(Math.pow(this.radius,2)-Math.pow(t,2)))},Circle.prototype.getPositionByAngle=function(t){if(null==t||isNaN(t))return null;var e=this.center.x+this.radius*Math.cos(t),i=this.center.y+this.radius*Math.sin(t);return new Point(e,i)},Rectangle.prototype=new GenericObject,Polygon.prototype=new GenericObject,Polygon.prototype.setRadius=function(t){this.radius=t,this.circle=new Circle(this.radius)},Polygon.prototype.setInnerRadius=function(t){this.innerRadius=t,this.innerCircle=new Circle(this.innerRadius)},Heart.prototype=new GenericObject,Heart.prototype.getPositionByAngle=function(t){if(null==t||isNaN(t))return null;var e=16*Math.pow(Math.sin(t),3),i=-(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t));return new Point(e,i)},Color.prototype=new GenericObject,Color.prototype.toHex=function(){var t=this.r<<16|this.g<<8|this.b;return function(t){return"#"+new Array(7-t.length).join("0")+t}(t.toString(16).toUpperCase())},Color.prototype.toRGBA=function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.a+")"},Color.prototype.setHex=function(t){this.r=t>>16,this.g=t>>8&255,this.b=255&t,this.hex=this.toHex()},Gradient.prototype=new GenericObject,Gradient.prototype.addColor=function(t){"GenericObject"==t.constructor.name&&"Color"==t.classname&&this.colors.push(t)},Gradient.prototype.getGradient=function(){var t=null;t=0==this.radius1||0==this.radius2?ctx.createLinearGradient(this.rect.p1.x,this.rect.p1.y,this.rect.p2.x,this.rect.p2.y):ctx.createRadialGradient(this.rect.p1.x,this.rect.p1.y,this.radius1,this.rect.p2.x,this.rect.p2.y,this.radius2);for(var e=0;e<this.colors.length;e++)t.addColorStop(e,this.colors[e].toHex());return t},BezierCurve.prototype=new GenericObject,BezierCurve.prototype.getPos=function(t){var e=new Point;return t2=t*t,t3=t2*t,mt=1-t,mt2=mt*mt,mt3=mt2*mt,e.x=mt3*this.startPoint.x+3*mt2*t*this.controlPoint1.x+3*mt*t2*this.controlPoint2.x+t3*this.endPoint.x,e.y=mt3*this.startPoint.y+3*mt2*t*this.controlPoint1.y+3*mt*t2*this.controlPoint2.y+t3*this.endPoint.y,e},Vector.prototype=new GenericObject,Vector.prototype.norm=function(){return this.p1.distance(this.p2)},Vector.prototype.component=function(t){switch(t.toUpperCase()){case"X":return this.p2.x-this.p1.x;case"Y":return this.p2.y-this.p1.y}},Vector.prototype.toPoint=function(t){(null==t||"GenericObject"!=t.constructor.name||"Point"!=t.classname)&&(t=new Point);var e=this.p1.x-t.x,i=this.p1.y-t.y,n=new Point(this.p1.x-e,this.p1.y-i),r=new Point(this.p2.x-e,this.p2.y-i);return new Vector(n,r)},Vector.prototype.toOrigin=function(){return this.toPoint(this.origin)},Vector.prototype.add=function(t){(null==t||"GenericObject"!=t.constructor.name||"Vector"!=t.classname)&&(t=new Vector(new Point,new Point));var e=this.toOrigin(),i=t.toPoint(e.p2),n=new Vector(e.p1,new Point(e.p1.x+i.p2.x,e.p1.y+i.p2.y));return n.toPoint(this.p1)},Vector.prototype.sub=function(t){(null==t||"GenericObject"!=t.constructor.name||"Vector"!=t.classname)&&(t=new Vector(new Point,new Point));var e=this.toOrigin(),i=t.toOrigin(),n=e.p2.x-i.p2.x,r=e.p2.y-i.p2.y,o=new Vector(e.p1,new Point(n,r));return o.toPoint(this.p1)},Vector.prototype.dot=function(t){if(null==t||"GenericObject"!=t.constructor.name||"Vector"!=t.classname)return null;var e=this.toOrigin(),i=t.toOrigin();return e.p2.x*i.p2.x+e.p2.y*i.p2.y},Vector.prototype.angleBetween=function(t){var e=this.toOrigin(),i=t.toOrigin();return Math.acos(e.dot(i)/(e.norm()*i.norm()))},Vector.prototype.unit=function(){var t=this.toOrigin(),e=t.norm(),i=new Vector(t.p1,new Point(t.p2.x/e,t.p2.y/e));return i.toPoint(this.p1)},Vector.prototype.zero=function(){return new Vector},Vector.prototype.inverse=function(t){if(null==t)return new Vector(this.p2,this.p1);var e=this.toOrigin(),i=new Vector;switch(t.toUpperCase()){case"X":i=new Vector(new Point,new Point(-e.p2.x,e.p2.y));break;case"Y":i=new Vector(new Point,new Point(e.p2.x,-e.p2.y))}return i.toPoint(this.p1)},GenericObject.prototype.clone=function(){var t=["Point","Rect","Circle","Rectangle","Heart","Polygon","Shape","Vector","Color","Gradient","BezierCurve"],e=[new Point,new Rect,new Circle,new Rectangle,new Heart,new Polygon,new Shape,new Vector,new Color,new Gradient,new BezierCurve],i=e[t.indexOf(this.classname)];for(var n in this)this.hasOwnProperty(n)&&(null!=this[n]&&"GenericObject"==this[n].constructor.name?i[n]=null!=this[n]?this[n].clone():null:i[n]=this[n]);return i},GenericObject.prototype.equals=function(t){var e=!0;if(this.classname!=t.classname)return!1;for(var i in this)this.hasOwnProperty(i)&&t.hasOwnProperty(i)&&("GenericObject"==this[i].constructor.name&&"GenericObject"==t[i].constructor.name?this[i].equals(t[i])||(e=!1):this[i]!=t[i]&&(e=!1));return e},GenericObject.prototype.toString=function(){var t=this.classname+"{";for(var e in this)if("classname"!=e&&this.hasOwnProperty(e)){var i=this[e],n="";n=null!=i&&"GenericObject"==i.constructor.name?i.toString():this[e],t+=e+": "+n+","}return t=t.substring(0,t.length-1),t+="}"},GenericObject.prototype.trace=function(){console.log(this.toString())};